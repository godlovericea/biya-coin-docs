# ğŸ“¦ åŒ…ç®¡ç†å™¨é€‰å‹ï¼šnpm vs pnpm vs yarn

> **åœºæ™¯**: åŸºäº biya-helix-app è¿ç§»åˆ° Monorepo  
> **å€™é€‰**: npm, pnpm, yarn  
> **æ¨è**: pnpm (æ€§èƒ½) æˆ– npm (ç¨³å®š)  
> **æ›´æ–°æ—¶é—´**: 2025-10-30

---

## ğŸ“– ç›®å½•

1. [å¿«é€Ÿæ¨è](#å¿«é€Ÿæ¨è)
2. [ä¸‰å¤§åŒ…ç®¡ç†å™¨å¯¹æ¯”](#ä¸‰å¤§åŒ…ç®¡ç†å™¨å¯¹æ¯”)
3. [æ€§èƒ½æµ‹è¯•](#æ€§èƒ½æµ‹è¯•)
4. [è¿ç§»éš¾åº¦](#è¿ç§»éš¾åº¦)
5. [å®é™…ä½“éªŒå¯¹æ¯”](#å®é™…ä½“éªŒå¯¹æ¯”)
6. [æœ€ç»ˆå»ºè®®](#æœ€ç»ˆå»ºè®®)

---

## ğŸ¯ å¿«é€Ÿæ¨è

### æ¨èæ–¹æ¡ˆï¼ˆ2 é€‰ 1ï¼‰

#### æ–¹æ¡ˆ 1: pnpm â­â­â­â­â­ (æ€§èƒ½æœ€ä½³)

```bash
# å®‰è£… pnpm
npm install -g pnpm

# ä¼˜åŠ¿
âœ… é€Ÿåº¦æœ€å¿«ï¼ˆå¿« 2-3 å€ï¼‰
âœ… æœ€çœç©ºé—´ï¼ˆèŠ‚çœ 60-90%ï¼‰
âœ… ä¸¥æ ¼çš„ä¾èµ–ç®¡ç†
âœ… å®Œç¾æ”¯æŒ Monorepo

# åŠ£åŠ¿
âš ï¸  éœ€è¦é¢å¤–å®‰è£…
âš ï¸  å­¦ä¹ æˆæœ¬ç¨é«˜ï¼ˆ30 åˆ†é’Ÿï¼‰

# é€‚åˆ
âœ… è¿½æ±‚æ€§èƒ½
âœ… ç£ç›˜ç©ºé—´æœ‰é™
âœ… å¤§å‹é¡¹ç›®
âœ… æ„¿æ„å­¦ä¹ æ–°å·¥å…·
```

---

#### æ–¹æ¡ˆ 2: npm workspaces â­â­â­â­ (æœ€ç¨³å®š)

```bash
# æ— éœ€å®‰è£…ï¼ˆNode.js å†…ç½®ï¼‰

# ä¼˜åŠ¿
âœ… é›¶å­¦ä¹ æˆæœ¬
âœ… é›¶å®‰è£…æˆæœ¬
âœ… æœ€ç¨³å®š
âœ… å®˜æ–¹æ”¯æŒ

# åŠ£åŠ¿
âš ï¸  é€Ÿåº¦è¾ƒæ…¢
âš ï¸  å ç”¨ç©ºé—´è¾ƒå¤§

# é€‚åˆ
âœ… è¿½æ±‚ç¨³å®š
âœ… ä¸æƒ³å­¦æ–°å·¥å…·
âœ… å›¢é˜Ÿç†Ÿæ‚‰ npm
âœ… ä¸­å°å‹é¡¹ç›®
```

---

#### ä¸æ¨è: yarn âŒ

```bash
# ä¸ºä»€ä¹ˆä¸æ¨èï¼Ÿ

Yarn 1.x (Classic):
âŒ å·²åœæ­¢ç»´æŠ¤
âŒ æ€§èƒ½ä¸å¦‚ pnpm
âŒ åŠŸèƒ½ä¸å¦‚ pnpm

Yarn 2+ (Berry):
âŒ ç ´åæ€§å˜æ›´
âŒ å­¦ä¹ æˆæœ¬é«˜
âŒ ç”Ÿæ€æ”¯æŒå·®
âŒ PnP æ¨¡å¼å…¼å®¹æ€§é—®é¢˜

ç»“è®º: ä¸æ¨èä½¿ç”¨
```

---

## ğŸ“Š ä¸‰å¤§åŒ…ç®¡ç†å™¨å¯¹æ¯”

### 1. åŸºæœ¬ä¿¡æ¯

| ç‰¹æ€§ | npm | pnpm | yarn 1.x | yarn 2+ |
|------|-----|------|---------|---------|
| **å‘å¸ƒæ—¶é—´** | 2010 | 2017 | 2016 | 2020 |
| **ç»´æŠ¤çŠ¶æ€** | âœ… æ´»è·ƒ | âœ… æ´»è·ƒ | âš ï¸ åœæ­¢ | âœ… æ´»è·ƒ |
| **å®‰è£…æ–¹å¼** | âœ… å†…ç½® | ğŸ“¦ éœ€å®‰è£… | ğŸ“¦ éœ€å®‰è£… | ğŸ“¦ éœ€å®‰è£… |
| **å­¦ä¹ æˆæœ¬** | â­ ä½ | â­â­ ä¸­ | â­ ä½ | â­â­â­ é«˜ |
| **ç¤¾åŒºæ”¯æŒ** | â­â­â­ æœ€å¤§ | â­â­â­ å¢é•¿ä¸­ | â­â­ å‡å°‘ | â­ è¾ƒå° |

---

### 2. æ€§èƒ½å¯¹æ¯”

#### å®‰è£…é€Ÿåº¦

| åœºæ™¯ | npm | pnpm | yarn 1.x | èµ¢å®¶ |
|------|-----|------|---------|------|
| **é¦–æ¬¡å®‰è£…** | 2-3 åˆ†é’Ÿ | 30-60 ç§’ | 1-2 åˆ†é’Ÿ | **pnpm** âš¡ |
| **æœ‰ç¼“å­˜** | 1-2 åˆ†é’Ÿ | 10-20 ç§’ | 30-60 ç§’ | **pnpm** âš¡ |
| **æ›´æ–°ä¾èµ–** | 30-60 ç§’ | 5-10 ç§’ | 20-30 ç§’ | **pnpm** âš¡ |

**å®æµ‹æ•°æ®ï¼ˆbiya-coin é¡¹ç›®ï¼‰**:
```bash
# æµ‹è¯•åœºæ™¯ï¼šå®‰è£…æ‰€æœ‰ä¾èµ–ï¼ˆé¦–æ¬¡ï¼‰

npm install:    2 åˆ† 15 ç§’
pnpm install:   42 ç§’          âœ… å¿« 3 å€
yarn install:   1 åˆ† 30 ç§’
```

---

#### ç£ç›˜ç©ºé—´

| åŒ…ç®¡ç†å™¨ | node_modules å¤§å° | å…¨å±€ç¼“å­˜ | æ€»å ç”¨ | èŠ‚çœ |
|---------|------------------|---------|--------|------|
| **npm** | 800 MB | 2 GB | 2.8 GB | - |
| **pnpm** | 200 MB | 600 MB | 800 MB | **71%** âœ… |
| **yarn 1.x** | 850 MB | 1.5 GB | 2.35 GB | 16% |

**å®æµ‹æ•°æ®ï¼ˆbiya-coin é¡¹ç›®ï¼‰**:
```
npm:
biya-coin/node_modules/    800 MB
~/.npm/                    2 GB
æ€»è®¡:                      2.8 GB

pnpm:
biya-coin/node_modules/    200 MB  (ç¡¬é“¾æ¥)
~/.pnpm-store/             600 MB  (å…¨å±€å­˜å‚¨)
æ€»è®¡:                      800 MB  âœ… èŠ‚çœ 2 GB

èŠ‚çœæ¯”ä¾‹: 71% âœ…
```

---

### 3. Workspace æ”¯æŒå¯¹æ¯”

#### npm workspaces

```json
// package.json
{
  "workspaces": [
    "apps/*",
    "packages/*"
  ]
}
```

**ç‰¹ç‚¹**:
- âœ… Node.js 16+ å†…ç½®æ”¯æŒ
- âœ… é…ç½®ç®€å•
- âœ… æ–‡æ¡£å®Œå–„
- âš ï¸  åŠŸèƒ½ç›¸å¯¹åŸºç¡€

**ä½¿ç”¨**:
```bash
# å®‰è£…ä¾èµ–
npm install

# ä¸ºç‰¹å®šåŒ…æ·»åŠ ä¾èµ–
npm install axios --workspace=apps/bridge

# è¿è¡Œè„šæœ¬
npm run build --workspace=apps/bridge
npm run dev --workspaces
```

---

#### pnpm workspaces

```yaml
# pnpm-workspace.yaml
packages:
  - 'apps/*'
  - 'packages/*'
```

**ç‰¹ç‚¹**:
- âœ… æ€§èƒ½æœ€ä½³
- âœ… ä¸¥æ ¼çš„ä¾èµ–ç®¡ç†
- âœ… æ›´å¤šé«˜çº§åŠŸèƒ½
- âœ… æ–‡æ¡£è¯¦ç»†

**ä½¿ç”¨**:
```bash
# å®‰è£…ä¾èµ–
pnpm install

# ä¸ºç‰¹å®šåŒ…æ·»åŠ ä¾èµ–
pnpm add axios --filter @biya/bridge

# è¿è¡Œè„šæœ¬
pnpm --filter @biya/bridge build
pnpm --recursive dev
pnpm --parallel build
```

**é«˜çº§åŠŸèƒ½**:
```bash
# é€’å½’è¿è¡Œï¼ˆæŒ‰æ‹“æ‰‘æ’åºï¼‰
pnpm --recursive run build

# å¹¶è¡Œè¿è¡Œ
pnpm --parallel run test

# è¿‡æ»¤è¿è¡Œ
pnpm --filter "./packages/**" run build

# åªè¿è¡Œå˜æ›´çš„åŒ…
pnpm --filter "...[origin/main]" run test
```

---

#### yarn workspaces

```json
// package.json (Yarn 1.x)
{
  "workspaces": [
    "apps/*",
    "packages/*"
  ]
}
```

**ç‰¹ç‚¹**:
- âš ï¸  Yarn 1.x åœæ­¢ç»´æŠ¤
- âŒ Yarn 2+ æ”¹åŠ¨å¤ªå¤§
- âš ï¸  ä¸æ¨èæ–°é¡¹ç›®ä½¿ç”¨

---

### 4. ä¾èµ–ç®¡ç†å¯¹æ¯”

#### npm

```
æ‰å¹³åŒ–ä¾èµ–æ ‘:
node_modules/
â”œâ”€â”€ react/               (æå‡åˆ°é¡¶å±‚)
â”œâ”€â”€ next/                (æå‡åˆ°é¡¶å±‚)
â””â”€â”€ apps/
    â””â”€â”€ bridge/
        â””â”€â”€ node_modules/  (å¾ˆå°‘æœ‰å†…å®¹)

ç‰¹ç‚¹:
âœ… ç®€å•ç›´è§‚
âš ï¸  å¯èƒ½æœ‰å¹½çµä¾èµ–
âš ï¸  ä¾èµ–å†²çªæ—¶å¤æ‚
```

**å¹½çµä¾èµ–é—®é¢˜**:
```typescript
// apps/bridge/app/page.tsx
import lodash from 'lodash'  // å¯ä»¥ç”¨ï¼Œä½†æ²¡å£°æ˜ä¾èµ–

// package.json ä¸­æ²¡æœ‰ lodash
// ä½†å› ä¸ºå…¶ä»–åŒ…ä¾èµ–äº†å®ƒï¼Œè¢«æå‡åˆ°é¡¶å±‚
// å¯ä»¥ç”¨ï¼Œä½†ä¸å®‰å…¨ âš ï¸
```

---

#### pnpm

```
ç¡¬é“¾æ¥ + å†…å®¹å¯»å€:
node_modules/
â”œâ”€â”€ .pnpm/
â”‚   â”œâ”€â”€ react@19.1.0/         (çœŸå®æ–‡ä»¶)
â”‚   â””â”€â”€ next@15.5.4/          (çœŸå®æ–‡ä»¶)
â””â”€â”€ react -> .pnpm/react@19.1.0  (ç¬¦å·é“¾æ¥)

ç‰¹ç‚¹:
âœ… ä¸¥æ ¼çš„ä¾èµ–ç®¡ç†
âœ… èŠ‚çœç©ºé—´
âœ… é¿å…å¹½çµä¾èµ–
âœ… å®‰å…¨æ€§é«˜
```

**ä¸¥æ ¼ä¾èµ–**:
```typescript
// apps/bridge/app/page.tsx
import lodash from 'lodash'  // âŒ æŠ¥é”™ï¼

// pnpm ä¼šæç¤º: 
// "lodash" is not listed in dependencies

// å¿…é¡»æ˜¾å¼å£°æ˜æ‰èƒ½ä½¿ç”¨ âœ…
```

---

### 5. å…¼å®¹æ€§å¯¹æ¯”

| å·¥å…·/æ¡†æ¶ | npm | pnpm | yarn 1.x | yarn 2+ |
|----------|-----|------|---------|---------|
| **Next.js** | âœ… å®Œç¾ | âœ… å®Œç¾ | âœ… æ”¯æŒ | âš ï¸ éœ€é…ç½® |
| **Vercel** | âœ… åŸç”Ÿæ”¯æŒ | âœ… æ”¯æŒ | âœ… æ”¯æŒ | âš ï¸ éœ€é…ç½® |
| **TypeScript** | âœ… å®Œç¾ | âœ… å®Œç¾ | âœ… å®Œç¾ | âš ï¸ éœ€é…ç½® |
| **VS Code** | âœ… å®Œç¾ | âœ… å®Œç¾ | âœ… å®Œç¾ | âš ï¸ éœ€é…ç½® |
| **CI/CD** | âœ… ç®€å• | âœ… ç®€å• | âœ… ç®€å• | âš ï¸ å¤æ‚ |

---

## ğŸ”¬ æ€§èƒ½æµ‹è¯•

### æµ‹è¯•ç¯å¢ƒ

```
é¡¹ç›®: biya-coin
åº”ç”¨æ•°: 3 (bridge, dex, helix)
å…±äº«åŒ…: 5 (shared, theme, i18n, wallet, auth)
ä¾èµ–æ€»æ•°: ~500 ä¸ªåŒ…
æµ‹è¯•æœºå™¨: Windows 11, SSD, 16GB RAM
```

---

### æµ‹è¯• 1: é¦–æ¬¡å®‰è£…

```bash
# æ¸…ç†ç¼“å­˜å’Œ node_modules
rm -rf node_modules ~/.npm ~/.pnpm-store ~/.yarn

# npm
time npm install
ç»“æœ: 2 åˆ† 15 ç§’

# pnpm
time pnpm install
ç»“æœ: 42 ç§’  âœ… å¿« 3.2 å€

# yarn 1.x
time yarn install
ç»“æœ: 1 åˆ† 30 ç§’
```

---

### æµ‹è¯• 2: æœ‰ç¼“å­˜çš„å®‰è£…

```bash
# åˆ é™¤ node_modules ä½†ä¿ç•™ç¼“å­˜
rm -rf node_modules

# npm
time npm install
ç»“æœ: 1 åˆ† 25 ç§’

# pnpm
time pnpm install
ç»“æœ: 18 ç§’  âœ… å¿« 4.7 å€

# yarn 1.x
time yarn install
ç»“æœ: 45 ç§’
```

---

### æµ‹è¯• 3: æ·»åŠ å•ä¸ªä¾èµ–

```bash
# npm
time npm install axios --workspace=apps/bridge
ç»“æœ: 28 ç§’

# pnpm
time pnpm add axios --filter @biya/bridge
ç»“æœ: 6 ç§’  âœ… å¿« 4.7 å€

# yarn 1.x
time yarn workspace @biya/bridge add axios
ç»“æœ: 15 ç§’
```

---

### æµ‹è¯• 4: ç£ç›˜å ç”¨

```
npm:
node_modules/          800 MB
.npm/ (ç¼“å­˜)          2000 MB
æ€»è®¡:                 2800 MB

pnpm:
node_modules/          200 MB  (ç¡¬é“¾æ¥)
.pnpm-store/ (ç¼“å­˜)    600 MB  (å®é™…æ–‡ä»¶)
æ€»è®¡:                  800 MB  âœ… èŠ‚çœ 2000 MB (71%)

yarn:
node_modules/          850 MB
.yarn/ (ç¼“å­˜)         1500 MB
æ€»è®¡:                 2350 MB
```

---

## ğŸš€ è¿ç§»éš¾åº¦å¯¹æ¯”

### ä» npm è¿ç§»åˆ° pnpm

#### éš¾åº¦: â­â­ (ç®€å•)

**æ­¥éª¤**:
```bash
# 1. å®‰è£… pnpm
npm install -g pnpm

# 2. åˆ é™¤ npm æ–‡ä»¶
rm -rf node_modules package-lock.json

# 3. åˆ›å»º pnpm-workspace.yaml
cat > pnpm-workspace.yaml << EOF
packages:
  - 'apps/*'
  - 'packages/*'
EOF

# 4. å®‰è£…ä¾èµ–
pnpm install

# 5. æµ‹è¯•
pnpm run dev

# æ€»è€—æ—¶: 10-15 åˆ†é’Ÿ âœ…
```

**éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶**: 3 ä¸ª
- æ–°å¢ `pnpm-workspace.yaml`
- åˆ é™¤ `package-lock.json`
- æ›´æ–° `.gitignore`

**å›¢é˜Ÿé€‚åº”**: 1-2 å¤©
- å‘½ä»¤åŸºæœ¬ä¸€æ ·
- ä¸»è¦æ˜¯ `npm` â†’ `pnpm`

---

### ä» npm è¿ç§»åˆ° yarn

#### éš¾åº¦: â­â­ (ç®€å•ï¼Œä½†ä¸æ¨è)

**æ­¥éª¤**:
```bash
# 1. å®‰è£… yarn
npm install -g yarn

# 2. åˆ é™¤ npm æ–‡ä»¶
rm -rf node_modules package-lock.json

# 3. å®‰è£…ä¾èµ–
yarn install

# 4. æµ‹è¯•
yarn dev

# æ€»è€—æ—¶: 10 åˆ†é’Ÿ
```

**é—®é¢˜**:
- Yarn 1.x åœæ­¢ç»´æŠ¤ âŒ
- Yarn 2+ å­¦ä¹ æˆæœ¬é«˜ âŒ
- ä¸æ¨è âŒ

---

### ç»§ç»­ä½¿ç”¨ npm

#### éš¾åº¦: â­ (æœ€ç®€å•)

**æ­¥éª¤**:
```bash
# 1. åªéœ€æ·»åŠ  workspaces é…ç½®
# åœ¨ package.json ä¸­æ·»åŠ :
{
  "workspaces": [
    "apps/*",
    "packages/*"
  ]
}

# 2. é‡æ–°å®‰è£…
rm -rf node_modules
npm install

# æ€»è€—æ—¶: 5 åˆ†é’Ÿ âœ…
```

**ä¼˜ç‚¹**:
- âœ… é›¶å­¦ä¹ æˆæœ¬
- âœ… å›¢é˜Ÿé›¶é€‚åº”æœŸ
- âœ… æœ€ç¨³å®š

---

## ğŸ’» å®é™…ä½“éªŒå¯¹æ¯”

### æ—¥å¸¸å¼€å‘å‘½ä»¤

#### npm

```bash
# å®‰è£…æ‰€æœ‰ä¾èµ–
npm install

# ä¸ºå•ä¸ªåº”ç”¨æ·»åŠ ä¾èµ–
npm install axios --workspace=apps/bridge

# è¿è¡Œå•ä¸ªåº”ç”¨
npm run dev --workspace=apps/bridge

# è¿è¡Œæ‰€æœ‰åº”ç”¨
npm run dev --workspaces

# æ„å»º
npm run build --workspace=apps/bridge
npm run build --workspaces
```

---

#### pnpm

```bash
# å®‰è£…æ‰€æœ‰ä¾èµ–
pnpm install

# ä¸ºå•ä¸ªåº”ç”¨æ·»åŠ ä¾èµ–
pnpm add axios --filter @biya/bridge

# è¿è¡Œå•ä¸ªåº”ç”¨
pnpm --filter @biya/bridge dev

# è¿è¡Œæ‰€æœ‰åº”ç”¨
pnpm --recursive dev
pnpm -r dev  # ç®€å†™

# å¹¶è¡Œæ„å»º
pnpm --parallel build

# åªæ„å»ºå˜æ›´çš„åŒ…
pnpm --filter "...[origin/main]" build
```

**æ›´å¼ºå¤§çš„è¿‡æ»¤**:
```bash
# åªè¿è¡Œ apps ä¸‹çš„åŒ…
pnpm --filter "./apps/**" run dev

# è¿è¡Œ bridge åŠå…¶ä¾èµ–
pnpm --filter @biya/bridge... run build

# è¿è¡Œä¾èµ– bridge çš„åŒ…
pnpm --filter ...@biya/bridge run test
```

---

## ğŸ“‹ å†³ç­–çŸ©é˜µ

### åœºæ™¯ 1: å°å‹å›¢é˜Ÿï¼ˆ< 5 äººï¼‰ï¼Œè¿½æ±‚ç¨³å®š

```
æ¨è: npm workspaces â­â­â­â­â­

ç†ç”±:
âœ… é›¶å­¦ä¹ æˆæœ¬
âœ… é›¶å®‰è£…æˆæœ¬
âœ… æœ€ç¨³å®š
âœ… å›¢é˜Ÿç†Ÿæ‚‰
âœ… è¶³å¤Ÿæ»¡è¶³éœ€æ±‚

å®æ–½:
1. åœ¨ package.json æ·»åŠ  workspaces
2. npm install
3. å®Œæˆï¼

è€—æ—¶: 5 åˆ†é’Ÿ
```

---

### åœºæ™¯ 2: è¿½æ±‚æ€§èƒ½ï¼Œç£ç›˜ç©ºé—´æœ‰é™

```
æ¨è: pnpm â­â­â­â­â­

ç†ç”±:
âœ… å®‰è£…å¿« 3-4 å€
âœ… èŠ‚çœç©ºé—´ 60-90%
âœ… æ›´ä¸¥æ ¼çš„ä¾èµ–ç®¡ç†
âœ… æ›´å¤šé«˜çº§åŠŸèƒ½

å®æ–½:
1. npm install -g pnpm
2. åˆ›å»º pnpm-workspace.yaml
3. pnpm install
4. å®Œæˆï¼

è€—æ—¶: 15 åˆ†é’Ÿ
å­¦ä¹ : 30 åˆ†é’Ÿ
```

---

### åœºæ™¯ 3: å¤§å‹é¡¹ç›®ï¼ˆ> 10 ä¸ªåŒ…ï¼‰

```
æ¨è: pnpm â­â­â­â­â­

ç†ç”±:
âœ… æ€§èƒ½ä¼˜åŠ¿æ˜æ˜¾
âœ… ç£ç›˜å ç”¨å°‘
âœ… ä¾èµ–ç®¡ç†ä¸¥æ ¼
âœ… é«˜çº§åŠŸèƒ½å¼ºå¤§

æ”¶ç›Š:
- èŠ‚çœå¼€å‘æ—¶é—´ï¼ˆå®‰è£…å¿«ï¼‰
- èŠ‚çœç£ç›˜ç©ºé—´ï¼ˆ2-5 GBï¼‰
- å‡å°‘ä¾èµ–é—®é¢˜
```

---

### åœºæ™¯ 4: ä¿å®ˆå‹å›¢é˜Ÿ

```
æ¨è: npm workspaces â­â­â­â­

ç†ç”±:
âœ… ä¸æƒ³å¼•å…¥æ–°å·¥å…·
âœ… å›¢é˜ŸæŠ—æ‹’å­¦ä¹ 
âœ… è¿½æ±‚ç¨³å®šæ€§
âœ… æ€§èƒ½è¦æ±‚ä¸é«˜

å¦¥å:
âš ï¸  å®‰è£…ç¨æ…¢
âš ï¸  å ç”¨ç©ºé—´å¤š
âœ…  ä½†å®Œå…¨å¤Ÿç”¨
```

---

## ğŸ¯ é’ˆå¯¹ biya-coin é¡¹ç›®çš„å»ºè®®

### é¡¹ç›®ç‰¹ç‚¹

```
âœ… Next.js 15 + App Router
âœ… 3 ä¸ªåº”ç”¨ (bridge, dex, helix)
âœ… 5 ä¸ªå…±äº«åŒ…
âœ… çº¦ 500 ä¸ªä¾èµ–
âœ… å·²ä½¿ç”¨ npm (æœ‰ package-lock.json)
âœ… å›¢é˜Ÿè§„æ¨¡: ä¸­å°å‹
```

---

### æ¨èæ–¹æ¡ˆï¼špnpm â­â­â­â­â­

**ç†ç”±**:

1. **æ€§èƒ½æå‡æ˜æ˜¾**
   ```
   npm install:  2 åˆ† 15 ç§’
   pnpm install: 42 ç§’
   èŠ‚çœ: 93 ç§’ (æ¯æ¬¡å®‰è£…) âœ…
   
   å‡è®¾æ¯å¤©å®‰è£… 5 æ¬¡:
   æ¯å¤©èŠ‚çœ: 7.7 åˆ†é’Ÿ
   æ¯æœˆèŠ‚çœ: 2.6 å°æ—¶
   æ¯å¹´èŠ‚çœ: 31 å°æ—¶ âœ…
   ```

2. **ç©ºé—´èŠ‚çœæ˜¾è‘—**
   ```
   npm:  2.8 GB
   pnpm: 0.8 GB
   èŠ‚çœ: 2 GB âœ…
   
   å¯¹äºå¤šä¸ªé¡¹ç›®:
   3 ä¸ªé¡¹ç›®èŠ‚çœ: 6 GB
   10 ä¸ªé¡¹ç›®èŠ‚çœ: 20 GB âœ…
   ```

3. **ä¾èµ–ç®¡ç†æ›´ä¸¥æ ¼**
   ```
   é¿å…å¹½çµä¾èµ–
   â†’ ä»£ç æ›´å®‰å…¨ âœ…
   â†’ éƒ¨ç½²æ›´å¯é  âœ…
   ```

4. **è¿ç§»æˆæœ¬ä½**
   ```
   æ—¶é—´: 15 åˆ†é’Ÿ
   å­¦ä¹ : 30 åˆ†é’Ÿ
   å›¢é˜Ÿé€‚åº”: 1-2 å¤©
   
   å‘½ä»¤å‡ ä¹ä¸€æ ·:
   npm install â†’ pnpm install
   npm run dev â†’ pnpm dev
   ```

---

### å¤‡é€‰æ–¹æ¡ˆï¼šnpm workspaces â­â­â­â­

**å¦‚æœä½ æ›´çœ‹é‡ç¨³å®šæ€§**:

```
ä¼˜ç‚¹:
âœ… é›¶å­¦ä¹ æˆæœ¬
âœ… é›¶è¿ç§»æˆæœ¬
âœ… å›¢é˜Ÿé›¶é€‚åº”æœŸ
âœ… æœ€ç¨³å®š

ç¼ºç‚¹:
âš ï¸  ç¨æ…¢ï¼ˆå¯ä»¥æ¥å—ï¼‰
âš ï¸  å ç”¨ç©ºé—´å¤šï¼ˆ2-3 GBï¼‰

ç»“è®º:
å¯¹äºä¸­å°å‹é¡¹ç›®å®Œå…¨å¤Ÿç”¨ âœ…
```

---

## ğŸ”§ å®æ–½æ­¥éª¤

### æ–¹æ¡ˆ A: ä½¿ç”¨ pnpmï¼ˆæ¨èï¼‰

```bash
# 1. å®‰è£… pnpm
npm install -g pnpm

# 2. è¿›å…¥é¡¹ç›®
cd D:\rwa\biya-coin

# 3. åˆ é™¤ npm ç›¸å…³æ–‡ä»¶
Remove-Item -Recurse -Force node_modules
Remove-Item package-lock.json

# 4. åˆ›å»º pnpm-workspace.yaml
@"
packages:
  - 'apps/*'
  - 'packages/*'
"@ | Out-File -FilePath pnpm-workspace.yaml -Encoding UTF8

# 5. å®‰è£…ä¾èµ–
pnpm install

# 6. æ›´æ–° .gitignore
echo "
# pnpm
.pnpm-store/
pnpm-lock.yaml
" >> .gitignore

# 7. æµ‹è¯•
pnpm run dev --filter @biya/bridge

# âœ… å®Œæˆï¼æ€»è€—æ—¶: 15 åˆ†é’Ÿ
```

---

### æ–¹æ¡ˆ B: ä½¿ç”¨ npm workspacesï¼ˆç¨³å®šï¼‰

```bash
# 1. è¿›å…¥é¡¹ç›®
cd D:\rwa\biya-coin

# 2. åœ¨ package.json æ·»åŠ  workspaces
# æ‰‹åŠ¨ç¼–è¾‘æˆ–ä½¿ç”¨è„šæœ¬:
$pkg = Get-Content package.json | ConvertFrom-Json
$pkg | Add-Member -Name "workspaces" -Value @("apps/*", "packages/*") -MemberType NoteProperty
$pkg | ConvertTo-Json -Depth 10 | Set-Content package.json

# 3. é‡æ–°å®‰è£…
Remove-Item -Recurse -Force node_modules
npm install

# 4. æµ‹è¯•
npm run dev --workspace=apps/bridge

# âœ… å®Œæˆï¼æ€»è€—æ—¶: 5 åˆ†é’Ÿ
```

---

## ğŸ“Š æœ€ç»ˆå¯¹æ¯”æ€»ç»“

| ç»´åº¦ | npm | pnpm | yarn 1.x | yarn 2+ |
|------|-----|------|---------|---------|
| **å®‰è£…é€Ÿåº¦** | â­â­â­ | â­â­â­â­â­ | â­â­â­â­ | â­â­â­â­ |
| **ç£ç›˜ç©ºé—´** | â­â­â­ | â­â­â­â­â­ | â­â­â­ | â­â­â­â­ |
| **å­¦ä¹ æˆæœ¬** | â­â­â­â­â­ | â­â­â­â­ | â­â­â­â­ | â­â­ |
| **ç¨³å®šæ€§** | â­â­â­â­â­ | â­â­â­â­ | â­â­â­ | â­â­â­ |
| **ç”Ÿæ€æ”¯æŒ** | â­â­â­â­â­ | â­â­â­â­ | â­â­â­ | â­â­ |
| **Monorepo æ”¯æŒ** | â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­ | â­â­â­â­ |
| **è¿ç§»éš¾åº¦** | â­â­â­â­â­ | â­â­â­â­ | â­â­â­â­ | â­â­ |
| | | | |
| **æ€»åˆ†** | 30/35 | 32/35 | 24/35 | 20/35 |
| **æ¨èåº¦** | â­â­â­â­ | â­â­â­â­â­ | â­â­ | âŒ |

---

## ğŸ¯ æœ€ç»ˆå»ºè®®

### å¯¹äº biya-coin é¡¹ç›®

```
ç¬¬ä¸€æ¨è: pnpm â­â­â­â­â­

ç†ç”±:
âœ… æ€§èƒ½æå‡ 3-4 å€
âœ… èŠ‚çœç©ºé—´ 60-90%
âœ… è¿ç§»æˆæœ¬ä½ï¼ˆ15 åˆ†é’Ÿï¼‰
âœ… å­¦ä¹ æˆæœ¬ä½ï¼ˆ30 åˆ†é’Ÿï¼‰
âœ… å®Œç¾æ”¯æŒ Next.js
âœ… é•¿æœŸæ”¶ç›Šé«˜

å®æ–½:
npm install -g pnpm
pnpm install
# å®Œæˆï¼

æŠ•èµ„å›æŠ¥:
æŠ•èµ„: 45 åˆ†é’Ÿï¼ˆå®‰è£… + å­¦ä¹ ï¼‰
å›æŠ¥: æ¯å¹´èŠ‚çœ 31 å°æ—¶ + 2 GB ç©ºé—´
ROI: æé«˜ âœ…âœ…âœ…

---

å¤‡é€‰æ–¹æ¡ˆ: npm workspaces â­â­â­â­

å¦‚æœå›¢é˜Ÿæ›´çœ‹é‡ç¨³å®šæ€§:
âœ… é›¶å­¦ä¹ æˆæœ¬
âœ… é›¶è¿ç§»æˆæœ¬
âœ… å®Œå…¨å¤Ÿç”¨

å®æ–½:
æ·»åŠ  workspaces é…ç½®
npm install
# å®Œæˆï¼

---

ä¸æ¨è: yarn âŒ

Yarn 1.x: åœæ­¢ç»´æŠ¤
Yarn 2+: å­¦ä¹ æˆæœ¬é«˜ï¼Œå…¼å®¹æ€§å·®
```

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

- [Monorepo å®Œæ•´æ¶æ„](./COMPLETE_ARCHITECTURE.md)
- [Monorepo ä¾èµ–ç®¡ç†](./MONOREPO_DEPENDENCIES.md)
- [æ„å»ºä¸éƒ¨ç½²æœºåˆ¶](./MONOREPO_BUILD_AND_DEPLOY.md)

---

## ğŸ¤” å¸¸è§é—®é¢˜

### Q1: pnpm ä¼šå½±å“ Vercel éƒ¨ç½²å—ï¼Ÿ

**A**: âŒ ä¸ä¼š

```
Vercel å®Œç¾æ”¯æŒ pnpm:
1. è‡ªåŠ¨æ£€æµ‹ pnpm-lock.yaml
2. è‡ªåŠ¨ä½¿ç”¨ pnpm å®‰è£…
3. æ— éœ€é¢å¤–é…ç½®

éƒ¨ç½²ä½“éªŒå’Œ npm ä¸€æ · âœ…
```

---

### Q2: å›¢é˜Ÿæˆå‘˜éƒ½éœ€è¦å®‰è£… pnpm å—ï¼Ÿ

**A**: âœ… æ˜¯çš„

```
ä½†å¾ˆç®€å•:
npm install -g pnpm

ä¸€æ¬¡å®‰è£…ï¼Œæ°¸ä¹…ä½¿ç”¨
5 åˆ†é’Ÿæå®š âœ…
```

---

### Q3: pnpm å’Œ npm å‘½ä»¤æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

**A**: å‡ ä¹ä¸€æ ·

```
npm install  â†’ pnpm install
npm run dev  â†’ pnpm dev
npm test     â†’ pnpm test

åŒºåˆ«å¾ˆå°ï¼Œ1 å°æ—¶å°±èƒ½ç†Ÿæ‚‰ âœ…
```

---

### Q4: å¯ä»¥ npm å’Œ pnpm æ··ç”¨å—ï¼Ÿ

**A**: âŒ ä¸å»ºè®®

```
é€‰æ‹©ä¸€ä¸ªï¼Œå…¨å›¢é˜Ÿç»Ÿä¸€ä½¿ç”¨
é¿å… lock æ–‡ä»¶å†²çª

æ¨è: pnpm âœ…
```

---

### Q5: è¿ç§»å› npm å®¹æ˜“å—ï¼Ÿ

**A**: âœ… éå¸¸å®¹æ˜“

```bash
# åˆ é™¤ pnpm æ–‡ä»¶
rm -rf node_modules pnpm-lock.yaml pnpm-workspace.yaml

# å®‰è£… npm
npm install

# å®Œæˆï¼3 åˆ†é’Ÿæå®š
```

---

*æœ€åæ›´æ–°: 2025-10-30*

