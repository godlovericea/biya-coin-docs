# 03 - 核心概念

> **适合人群**: 所有人  
> **阅读时间**: 15 分钟

---

## 📖 目录

1. [Peggy Bridge](#peggy-bridge)
2. [Axelar Bridge](#axelar-bridge)
3. [代币类型](#代币类型)
4. [钱包管理](#钱包管理)
5. [Gas 费用](#gas-费用)
6. [关键术语](#关键术语)

---

## 🌉 Peggy Bridge

### 什么是 Peggy?

**Peggy** 是 Injective 官方的以太坊↔️Injective 跨链桥，基于 **Gravity Bridge** 技术。

### 工作原理

```
以太坊                      Peggy Bridge                  Injective
  ↓                            ↓                            ↓
┌─────────┐              ┌──────────┐              ┌─────────┐
│ 100 USDT│  ──锁定──>  │ 验证器集 │  ──铸造──>  │ 100 USDT│
│ (ERC20) │              │ 多重签名 │              │ (Peggy) │
└─────────┘              └──────────┘              └─────────┘
```

**关键步骤**：

1. **存款（Deposit）**：
   - 用户在以太坊调用 Peggy 合约
   - 合约锁定用户的 ERC20 代币
   - 验证器监听锁定事件
   
2. **验证（Validation）**：
   - 多个验证器确认交易
   - 达成共识后签名
   - 生成跨链证明
   
3. **铸造（Mint）**：
   - 在 Injective 上铸造等量代币
   - 代币前缀为 `peggy`
   - 用户可以在 Injective 使用

### Peggy 合约地址

| 网络 | 合约地址 |
|------|---------|
| 以太坊主网 | `0xF955C57f9EA9Dc8781965FEaE0b6A2acE2BAD6f3` |
| Sepolia 测试网 | `0x513DFF2bdccabcc9B65241F1211DC243c11f1684` |

### 支持的代币

```typescript
// 原生 ERC20 代币 → Peggy 代币
ETH USDT (0xdAC17F958D2ee523a2206206994597C13D831ec7)
  ↓
INJ USDT (peggy0xdAC17F958D2ee523a2206206994597C13D831ec7)

ETH INJ (0xe28b3b32b6c345a34ff64674606124dd5aceca30)
  ↓
INJ INJ (peggy0xe28b3b32b6c345a34ff64674606124dd5aceca30)
```

### 优缺点

✅ **优点**：
- 官方支持，安全性高
- 去中心化，由验证器保证
- 手续费低（无协议费）
- 直接桥接，速度快

❌ **缺点**：
- 只支持以太坊
- Gas 费较高（以太坊 Layer 1）
- 需要多个确认

---

## 🔗 Axelar Bridge

### 什么是 Axelar?

**Axelar** 是一个跨链通信协议，支持多条区块链之间的资产转移。

### 工作原理

```
源链                  Axelar 网络                目标链
(BSC/Polygon)         (验证器)                 (Injective)
  ↓                      ↓                         ↓
┌─────────┐        ┌──────────┐            ┌─────────┐
│ 100 USDT│ ──>   │  路由器  │  ──>      │ axlUSDC │
│ (BEP20) │        │  验证器  │            │ (IBC)   │
└─────────┘        └──────────┘            └─────────┘
```

**关键步骤**：

1. **锁定（Lock）**：
   - 用户在源链锁定代币
   - Axelar 网关合约接收
   
2. **路由（Route）**：
   - Axelar 验证器确认
   - 计算最优路径
   - 生成跨链消息
   
3. **释放（Release）**：
   - 在目标链释放代币
   - 通过 IBC 传输
   - 用户收到 Axelar 包装的代币

### 支持的网络

```
Axelar 支持：
  ├── Ethereum
  ├── BNB Chain (BSC)
  ├── Polygon
  ├── Avalanche
  ├── Arbitrum
  └── ... 40+ 链
```

### 代币映射

```typescript
// 各链 USDC → Axelar USDC
BSC USDC → axlUSDC (IBC)
Polygon USDC → axlUSDC (IBC)
Avalanche USDC → axlUSDC (IBC)
```

### 优缺点

✅ **优点**：
- 支持多条链
- 路径灵活
- 更低的 Gas 费（支持 Layer 2）
- 可以跨多个链

❌ **缺点**：
- 有协议费（0.1%-0.3%）
- 验证时间可能较长
- 代币是包装的（axl 前缀）

---

## 🪙 代币类型

### 1. **原生代币（Native Token）**

```typescript
// Injective 原生代币
{
  symbol: "INJ",
  denom: "inj",
  decimals: 18,
  isNative: true
}
```

**特点**：
- 链的原生资产
- 用于支付 Gas 费
- 不需要桥接（本身就在链上）

### 2. **ERC20 代币**

```typescript
// 以太坊 ERC20 标准代币
{
  symbol: "USDT",
  address: "0xdAC17F958D2ee523a2206206994597C13D831ec7",
  decimals: 6,
  tokenType: TokenType.Erc20
}
```

**特点**：
- 以太坊上的智能合约代币
- 需要通过 Peggy 桥接
- 在 Injective 上变成 Peggy 代币

### 3. **Peggy 代币**

```typescript
// Peggy 包装的代币
{
  symbol: "USDT",
  denom: "peggy0xdAC17F958D2ee523a2206206994597C13D831ec7",
  decimals: 6
}
```

**特点**：
- 通过 Peggy 桥接的代币
- `denom` 以 `peggy` 开头
- 与以太坊原代币 1:1 锚定

### 4. **IBC 代币**

```typescript
// 通过 IBC 传输的代币
{
  symbol: "axl.USDC",
  denom: "ibc/7E1AF94AD246BE522892751046F0C959B768642E5671CC3742264068D49553C0",
  decimals: 18
}
```

**特点**：
- 通过 Axelar/IBC 传输
- `denom` 以 `ibc/` 开头
- 来自其他 Cosmos 生态链

### 代币精度（Decimals）

```
代币       精度    最小单位              示例
INJ        18      0.000000000000000001  1 INJ = 10^18 wei
USDT       6       0.000001              1 USDT = 10^6 μUSDT
axlUSDC    18      0.000000000000000001  1 USDC = 10^18 wei
```

**重要**：在计算和显示时必须考虑精度！

---

## 👛 钱包管理

### 支持的钱包

#### 1. **Cosmos 钱包**（用于 Injective）

```
┌─────────────┐
│    Keplr    │ ← 推荐
│   钱包扩展   │
└─────────────┘

┌─────────────┐
│    Leap     │
│   钱包扩展   │
└─────────────┘
```

**功能**：
- 管理 Injective 地址
- 签名 Cosmos 交易
- 查看余额和历史

#### 2. **EVM 钱包**（用于以太坊/BSC）

```
┌─────────────┐
│  MetaMask   │ ← 推荐
│   钱包扩展   │
└─────────────┘

┌─────────────┐
│ OKX Wallet  │
│   钱包扩展   │
└─────────────┘
```

**功能**：
- 管理以太坊/BSC 地址
- 签名 EVM 交易
- 与 DApp 交互

### 钱包策略（WalletStrategy）

```typescript
// 统一的钱包接口
const walletStrategy = new WalletStrategy({
  chainId: CHAIN_ID,              // Injective 链 ID
  ethereumOptions: {
    ethereumChainId: 1,            // 以太坊链 ID
    rpcUrl: alchemyRpcEndpoint
  },
  walletConnectOptions: {
    projectId: WALLET_CONNECT_PROJECT_ID
  }
})
```

**职责**：
- 统一多钱包接口
- 管理钱包连接状态
- 切换不同的钱包

### 地址格式

```
以太坊地址:
0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb

Injective地址:
inj1dzqd00lfd4y4qy2pxa0dsdwzfnmsu27hgttswz
```

**注意**：
- 两种地址格式完全不同
- 需要同时连接两个钱包
- 不能混用

---

## ⛽ Gas 费用

### 什么是 Gas?

**Gas** 是区块链网络的"燃料费"，用于支付计算和存储成本。

### Gas 相关概念

#### 1. **Gas Limit**
```
Gas Limit = 交易最多消耗的 Gas 数量

例如：
- 简单转账: 21,000 Gas
- 代币授权: 45,000 Gas
- Peggy 存款: 100,000 Gas
```

#### 2. **Gas Price**
```
Gas Price = 每单位 Gas 的价格

单位：Gwei (1 Gwei = 0.000000001 ETH)

例如：
- 低速: 10 Gwei
- 标准: 30 Gwei
- 快速: 100 Gwei
```

#### 3. **交易费用**
```
交易费用 = Gas Limit × Gas Price

例如：
100,000 Gas × 30 Gwei = 3,000,000 Gwei = 0.003 ETH ≈ $10
```

### 不同链的 Gas 费

| 链 | Gas 代币 | 平均费用 | 确认时间 |
|---|---------|---------|---------|
| 以太坊 | ETH | $10-$50 | 1-5分钟 |
| BNB Chain | BNB | $0.1-$1 | 5-30秒 |
| Injective | INJ | $0.01 | 1-3秒 |

### 优化 Gas 费

✅ **建议**：
- 选择低费用时段（凌晨）
- 使用 Layer 2 或侧链（BSC）
- 批量操作（减少交易次数）
- 设置合理的 Gas Price

---

## 📚 关键术语

### A

**ABI (Application Binary Interface)**
- 智能合约的接口定义
- 用于调用合约方法
- JSON 格式

**Allowance（授权额度）**
- ERC20 代币的授权机制
- 允许合约使用你的代币
- 需要先 `approve()` 再 `transfer()`

**Axelar**
- 跨链通信协议
- 支持多链资产转移

### B

**Bridge（桥接）**
- 连接不同区块链的基础设施
- 允许资产跨链转移

**Block Confirmation（区块确认）**
- 交易被打包到区块后的确认数
- 更多确认 = 更安全
- 以太坊通常需要 12 个确认

### D

**Denom（面额/单位）**
- Cosmos 链上的代币标识符
- 如：`inj`、`peggy0x...`、`ibc/...`

**Deposit（存款）**
- 从外部链转入 Injective
- 通过跨链桥实现

### E

**ERC20**
- 以太坊代币标准
- 定义了统一的接口
- 如：USDT、USDC、INJ

**EVM (Ethereum Virtual Machine)**
- 以太坊虚拟机
- 执行智能合约
- BSC、Polygon 也兼容

### G

**Gas**
- 区块链交易费用
- 支付给矿工/验证器
- 不同链费用差异大

**Gwei**
- Gas 价格单位
- 1 Gwei = 10^-9 ETH
- 1 ETH = 1,000,000,000 Gwei

### I

**IBC (Inter-Blockchain Communication)**
- Cosmos 跨链通信协议
- 用于 Cosmos 生态链之间转账
- Axelar 使用 IBC 连接 Injective

**Injective**
- Layer 1 区块链
- 专注于 DeFi
- 使用 Tendermint 共识

### P

**Peggy**
- Injective 的以太坊桥
- 基于 Gravity Bridge
- 由验证器保证安全

**Provider（提供者）**
- React Context 的包装器
- 提供全局状态
- 如：WalletProvider、AccountProvider

### T

**Token（代币）**
- 区块链上的资产
- 可以是原生代币或智能合约代币

**Transaction Hash（交易哈希）**
- 交易的唯一标识符
- 用于查询交易状态
- 如：`0x1234...abcd`

### W

**Wallet（钱包）**
- 管理私钥和地址
- 签名交易
- 如：Keplr、MetaMask

**Wagmi**
- React Hooks for Ethereum
- 简化 EVM 链交互
- 支持多种钱包

**WalletConnect**
- 开放的钱包连接协议
- 支持移动端钱包
- 通过二维码连接

---

## 💡 概念对比

### Peggy vs Axelar

| 特性 | Peggy | Axelar |
|------|-------|--------|
| 支持链 | 以太坊 | 40+ 链 |
| 去中心化 | ✅ 高 | ✅ 高 |
| 速度 | 🚀 快 | 🐢 中 |
| 手续费 | 💰 Gas only | 💰 Gas + 协议费 |
| 代币前缀 | `peggy` | `axl` / `ibc` |
| 安全性 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ |

### ERC20 vs Native Token

| 特性 | ERC20 | Native Token |
|------|-------|--------------|
| 部署方式 | 智能合约 | 链原生 |
| Gas 费 | 较高 | 较低 |
| 桥接 | 需要 | 不需要 |
| 示例 | USDT, USDC | INJ, ETH, BNB |

---

## 📖 下一步

- 👉 [数据流程](./04-数据流程.md) - 了解交易如何执行
- 👉 [组件说明](./05-组件说明.md) - 查看代码模块
- 👉 [常见问题](./07-常见问题.md) - 解决疑问

---

*最后更新: 2025-10-30*

