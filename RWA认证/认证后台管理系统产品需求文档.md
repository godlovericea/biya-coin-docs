# 认证后台管理系统产品需求文档

## 文档信息

| 项目 | 内容 |
|------|------|
| 文档名称 | 认证后台管理系统产品需求文档 |
| 产品名称 | 认证后台管理系统 |
| 文档版本 | V1.2 |
| 创建日期 | 2025-11-06 |
| 最后更新 | 2025-11-07 |

## 目录

- [1. 产品概述](#1-产品概述)
- [2. 功能架构](#2-功能架构)
- [3. 功能需求](#3-功能需求)
- [4. 非功能需求](#4-非功能需求)
- [5. 业务规则](#5-业务规则)
- [6. 数据字典](#6-数据字典)
- [7. 界面原型说明](#7-界面原型说明)

---

## 1. 产品概述

### 1.1 产品定位

认证后台管理系统是一个面向运营和风控人员的管理后台，用于审核和管理用户提交的各类认证申请，包括KYC、KYB、UBO、合规审核/审查、账户操作人、专业投资者认证等多种认证类型。系统提供统一的审核流程管理、数据查询、状态监控和综合审查功能。

### 1.2 目标用户

- **主要用户**：认证审核员、风控专员、运营管理员
- **次要用户**：系统管理员、高级管理人员

### 1.3 核心价值

- 提供统一的认证审核管理平台
- 提高审核效率和准确性
- 实现认证流程的标准化和可追溯
- 支持多种认证类型的综合管理
- 提供实时数据统计和监控功能

### 1.4 产品范围

系统覆盖以下认证类型的审核管理：
- KYC补充信息认证
- KYB机构认证
- UBO（最终受益所有人）认证
- 合规审查认证（个人）
- 合规审核认证（企业）
- 账户操作人认证（机构）
- 专业投资者认证（个人）
- 专业投资者认证（机构）
- RWA综合审查（个人和机构）

---

## 2. 功能架构

### 2.1 系统架构图

```
认证后台管理系统
├── 仪表盘模块
│   ├── 统计数据展示
│   ├── 近期待审核列表（整卡可点击，直接进入详情）
│   └── 认证类型分布
├── 认证管理模块
│   ├── KYC补充信息
│   ├── KYB机构认证
│   ├── UBO认证
│   ├── 合规审查认证（个人）
│   ├── 合规审核认证（企业）
│   ├── 账户操作人认证（机构）
│   ├── 专业投资者认证（个人）
│   └── 专业投资者认证（机构）
└── 综合审查模块
    ├── RWA个人认证审查（点击状态直接跳转详情，含风险测评结果）
    └── RWA机构认证审查（点击状态直接跳转详情，含账户操作人、UBO详情、风险测评结果）
```

### 2.2 业务流程图

```
用户提交认证申请
    ↓
进入待审核队列
    ↓
审核员查看列表
    ↓
选择申请进入详情页
    ↓
审核材料和信息
    ↓
做出审核决定 ──┬── 通过 → 更新状态 → 通知用户
                ├── 驳回 → 填写原因 → 通知用户
                └── 需补充 → 填写说明 → 通知用户
                                ↓
                        用户补充材料
                                ↓
                        重新进入审核队列
```

---

## 3. 功能需求

### 3.1 左侧导航栏

#### 3.1.1 待审核数量提示

**功能描述**：在左侧导航栏的认证管理菜单项右侧显示待审核数量徽章

**功能要点**：

1. **统计范围**
   - 统计该认证类型下所有"待审核"（pending）状态的申请
   - 统计该认证类型下所有"补充材料待审核"（supplement_submitted）状态的申请
   - 两种状态的申请数量合计

2. **显示规则**
   - 每个认证类型菜单项右侧都显示对应的待审核数量
   - 数量实时更新，无需手动刷新
   - 数量为 0 时仍然显示"0"
   - 数据加载失败时显示"0"

3. **样式设计**
   - 位置：菜单项右侧，使用浮动布局
   - 背景色：浅蓝色（#DBEAFE）
   - 文字颜色：蓝色（#2563EB）
   - 形状：完全圆角徽章
   - 字体大小：12px
   - 内边距：上下 2px，左右 8px

4. **交互行为**
   - 点击菜单项进入对应的认证列表页
   - 徽章本身不可点击，仅作为提示
   - 菜单项悬停或激活时，徽章样式保持不变

**业务价值**：
- 帮助审核员快速了解各认证类型的待审核工作量
- 提高工作效率，优先处理待审核量大的类型
- 提供实时的工作状态反馈

---

### 3.2 仪表盘模块

#### 3.2.1 统计数据展示

**功能描述**：在仪表盘顶部展示关键统计数据卡片

**功能要点**：

1. **待审核申请数**
   - 展示所有认证类型待审核和补充材料待审核的总数
   - 标签：黄色"待处理"
   - 实时更新统计数据

2. **今日已审核数**
   - 展示当天已完成审核的申请数量
   - 标签：绿色"今日"
   - 每日零点重置

3. **即将过期数**
   - 展示即将过期的认证申请数量
   - 标签：红色"紧急"
   - 按过期时间优先级排序

4. **本月审核总数**
   - 展示本月累计审核的申请总数
   - 标签：蓝色"本月"
   - 每月初重置

**界面规范**：
- 卡片采用网格布局，4列展示
- 每个卡片包含图标、数字、标签和描述文字
- 响应式设计，移动端自适应为1列或2列

#### 3.2.2 近期待审核列表

**功能描述**：展示最近提交的待审核申请，按时间倒序排列

**功能要点**：

1. **列表内容**
   - 用户账号首字母头像
   - 用户账号名称
   - 联系方式（邮箱或电话）
   - 认证类型
   - "查看详情"按钮（带右箭头图标）

2. **数据范围**
   - 展示状态为"待审核"和"补充材料待审核"的申请
   - 最多展示5条记录
   - 按提交时间倒序排列

3. **交互功能**
   - **整卡可点击**：点击卡片任意位置直接进入该认证的详情页
   - **悬停效果**：
     - 背景色变化（hover:bg-gray-100）
     - 显示阴影效果（hover:shadow-md）
     - 视觉反馈明显
   - **直接进入详情**：点击后直接打开详情页，无需二次点击

4. **UI优化**
   - 操作按钮文案："查看详情"（而非"审核"）
   - 右箭头图标：提供明确的导航提示
   - 整体交互更加流畅和直观

**业务规则**：
- 自动从所有认证类型中汇总数据
- 实时更新列表内容
- 点击后立即进入审核详情页面，提高审核效率

#### 3.2.3 认证类型分布

**功能描述**：以进度条形式展示各认证类型的待审核数量分布

**功能要点**：

1. **展示内容**
   - 认证类型名称
   - 进度条（按比例显示）
   - 具体数量

2. **认证类型包括**：
   - KYC补充信息（蓝色）
   - KYB机构认证（绿色）
   - UBO认证（黄色）
   - 合规审查/审核认证（紫色）
   - 账户操作人认证（青色）
   - 专业投资者认证（红色）

3. **数据计算**
   - 进度条宽度 = (该类型待审核数 / 总待审核数) × 100%
   - 实时统计更新

---

### 3.3 认证管理模块

#### 3.3.1 通用列表页功能

所有认证类型的列表页共享以下通用功能：

##### 3.3.1.1 筛选和搜索

**功能描述**：提供多维度的筛选和搜索功能，帮助审核员快速定位目标申请

**界面布局**：
- 第一行：用户账号、申请渠道、状态（3列网格布局）
- 第二行：开始时间、结束时间（2列网格布局）
- 响应式设计：移动端自适应为单列布局

**筛选条件**：

1. **用户账号搜索**
   - 输入框：支持模糊搜索
   - 搜索范围：用户账号、邮箱、联系方式
   - 实时搜索或按回车触发

2. **申请渠道筛选**
   - 下拉选择：全部渠道、钱包、US、RWA
   - 单选模式
   - 支持清空筛选

3. **状态筛选**
   - 全部状态
   - 待审核（pending）
   - 已通过（approved）
   - 已驳回（rejected）
   - 需补充材料（supplement）
   - 补充材料待审核（supplement_submitted）
   - 已过期（expired）

4. **时间筛选**
   - 开始时间：日期选择器（date类型输入框）
   - 结束时间：日期选择器（date类型输入框）
   - 支持选择任意时间范围
   - 可单独选择开始时间或结束时间
   - 根据提交时间字段进行筛选
   - 筛选逻辑：
     - 仅选择开始时间：筛选该日期及之后的数据
     - 仅选择结束时间：筛选该日期及之前的数据
     - 同时选择：筛选该时间范围内的数据

**交互规则**：
- 筛选条件支持组合使用
- 修改筛选条件后自动刷新列表
- 保留用户筛选偏好设置（本地存储）
- 时间筛选支持清空按钮，快速清除时间范围

##### 3.3.1.2 列表展示

**功能描述**：以表格形式展示认证申请列表

**表格列**：

1. **用户账号**
   - 主文本：用户账号名称
   - 副文本：邮箱或联系方式

2. **申请渠道**
   - 标签形式展示
   - 钱包（紫色）
   - US（蓝色）
   - RWA（绿色）

3. **提交时间**
   - 格式：YYYY-MM-DD HH:mm
   - 按时间倒序排列

4. **状态**
   - 标签形式展示
   - 待审核（黄色）
   - 已通过（绿色）
   - 已驳回（红色）
   - 需补充材料（蓝色）
   - 补充材料待审核（橙色）
   - 已过期（灰色）

5. **操作**
   - 查看详情按钮（所有状态）
   - 快速通过按钮（仅待审核状态）
   - 快速驳回按钮（仅待审核状态）

**交互功能**：
- 点击行可进入详情页
- 悬停显示高亮效果
- 支持排序功能（按时间、状态等）

##### 3.3.1.3 分页功能

**功能描述**：对列表数据进行分页展示

**功能要点**：
- 每页显示10条记录（可配置）
- 显示当前页码和总记录数
- 上一页、下一页按钮
- 页码快速跳转
- 显示"显示 1 到 10 共 XX 条"信息

##### 3.3.1.4 快速操作

**功能描述**：在列表页提供快速审核操作

**快速通过**：
1. 点击"快速通过"按钮
2. 弹出确认对话框："确定要快速通过 [用户账号] 的认证申请吗？"
3. 确认后更新状态为"已通过"
4. 发送通知邮件给用户
5. 记录审核日志

**快速驳回**：
1. 点击"快速驳回"按钮
2. 弹出输入框要求填写驳回理由
3. 确认后更新状态为"已驳回"
4. 发送通知邮件给用户（包含驳回理由）
5. 记录审核日志

**业务规则**：
- 仅对"待审核"和"补充材料待审核"状态的申请显示快速操作按钮
- 快速操作需要记录操作人和操作时间
- 快速操作不需要验证码（可选配置）

#### 3.3.2 通用详情页功能

##### 3.3.2.1 基本信息展示

**功能描述**：展示认证申请的基本信息

**展示内容**：

1. **用户账号**
   - 显示为蓝色可点击链接
   - 点击可跳转到用户详情页（如有）

2. **申请渠道**
   - 标签形式展示
   - 钱包（紫色）/ US（蓝色）/ RWA（绿色）

3. **提交时间**
   - 格式：YYYY-MM-DD HH:mm

4. **当前状态**
   - 标签形式展示，颜色与列表页一致

5. **认证类型**
   - 显示具体的认证类型名称

6. **补充材料说明**（仅在需补充材料状态时显示）
   - 显示为橙色文字
   - 展示审核员要求补充的材料说明

7. **驳回原因**（仅在已驳回状态时显示）
   - 显示为红色文字
   - 展示审核员填写的驳回原因

**布局规范**：
- 2列网格布局
- 标签和内容上下排列
- 补充说明和驳回原因占满2列

##### 3.3.2.2 详细数据展示

**功能描述**：展示认证申请中提交的详细信息

**展示内容**：
- 根据不同认证类型展示对应的字段信息
- 每个字段包含标签和值
- 字段之间用分隔线分隔

**示例（KYC补充信息）**：
- 居住国家
- 出生地
- 职业
- 行业
- 资金来源

**示例（KYB机构认证）**：
- 公司名称
- 注册号
- 注册国家
- 公司类型

**示例（UBO认证）**：

UBO认证详情页需要特殊处理，根据机构是否填写UBO人员展示不同内容：

1. **有UBO人员的情况**（`hasPersonnel: true`）
   - 显示绿色成功提示："✓ 已填写股东和实际控制人信息"
   - **25%以上股东信息**：
     - 标题："25%以上股东"
     - 列表展示所有股东：
       - 姓名
       - 持股比例（如：30%）
       - "股东"标签（绿色）
     - 每个股东信息独立卡片展示
   - **实际控制人信息**：
     - 标题："实际控制人"
     - 列表展示所有实际控制人：
       - 姓名
       - 职位/角色（如：董事长、CEO）
       - "实际控制人"标签（蓝色）
     - 每个实际控制人信息独立卡片展示

2. **无UBO人员的情况**（`hasPersonnel: false`）
   - 显示橙色警告提示："⚠️ 机构声明无股东和实际控制人"
   - **原因说明区域**：
     - 标题："原因说明"
     - 浅灰色背景卡片
     - 展示机构填写的详细原因文本
     - 示例："本公司为特殊目的公司(SPV)，无实际股东和实际控制人，由母公司全资控制。根据相关法律法规，作为SPV无需披露个人股东信息。"
   - **证明文件区域**：
     - 标题："证明文件"
     - 文件列表展示（支持多个文件）：
       - 文件图标（根据类型显示PDF/图片等图标）
       - 文件名称
       - 文件大小
       - "查看"按钮（可预览或下载文件）
     - 每个文件独立卡片展示

**数据来源**：
- 从 `uboDetails` 字段获取数据
- `hasPersonnel` 字段决定展示哪种布局
- `shareholders` 数组包含股东信息
- `actualControllers` 数组包含实际控制人信息
- `reason` 字段包含无UBO人员的原因说明
- `proofFiles` 数组包含证明文件列表

**业务规则**：
- 股东和实际控制人可以独立填写，也可以只填其中一项
- 如果既没有股东也没有实际控制人，则必须填写原因并上传证明文件
- 证明文件支持多个文件上传
- 审核员需要重点审核无UBO人员情况的合理性和证明文件的有效性

##### 3.3.2.3 上传文件管理

**功能描述**：展示用户上传的认证材料文件

**展示内容**：

1. **文件列表**
   - 文件图标
   - 文件名称
   - 文件类型（如：PDF文档）
   - 查看按钮

2. **补充材料区域**（仅在补充材料已提交状态时显示）
   - 独立展示区域，橙色边框高亮
   - 标题："📎 补充材料"，带"新上传"标签
   - 补充文件列表
   - 每个文件显示"补充"标签
   - 显示上传时间

3. **空状态**
   - 当无文件时显示"暂无上传文件"提示
   - 灰色图标和提示文字

**交互功能**：
- 点击"查看"按钮预览或下载文件
- 支持PDF、图片等多种格式预览
- 文件加载失败时显示错误提示

##### 3.3.2.4 审核操作

**功能描述**：提供审核决策操作界面

**审核状态判断**：

1. **可审核状态**（待审核、补充材料待审核）
   
   **操作界面包含**：
   
   a. **补充材料提示**（仅补充材料待审核状态）
      - 橙色背景提示框
      - 提示文字："📌 补充材料已提交"
      - 副文本："用户已提交补充材料，请审核"
   
   b. **审核结果选择**
      - 下拉选择框
      - 选项：
        - 请选择审核结果（默认）
        - ✅ 通过
        - ❌ 驳回
        - 📝 需补充材料
   
   c. **驳回原因输入**（选择"驳回"时显示）
      - 多行文本输入框（4行）
      - 必填标记（红色星号）
      - 占位符："请输入驳回原因..."
   
   d. **补充材料说明输入**（选择"需补充材料"时显示）
      - 多行文本输入框（3行）
      - 占位符："请说明需要补充哪些材料..."
   
   e. **身份验证码输入**
      - 单行文本输入框
      - 必填标记（红色星号）
      - 最大长度：6位
      - 占位符："请输入身份验证器的6位验证码"
      - 提示文字："请使用您的身份验证器APP生成验证码"
   
   f. **提交审核按钮**
      - 蓝色主按钮
      - 文字："提交审核"
      - 未选择审核结果时置灰且不可点击

2. **已审核状态**（已通过、已驳回、需补充材料、已过期）
   
   **展示内容**：
   - 大号状态图标（✅/❌/📝/⏰）
   - 状态说明文字
   - 当前状态标签

**提交逻辑**：

1. **表单验证**
   - 必须选择审核结果
   - 驳回时必须填写驳回原因
   - 必须输入6位验证码

2. **提交确认**
   - 弹出确认对话框："确定提交审核结果吗？"
   - 用户确认后提交

3. **提交成功**
   - 更新申请状态
   - 记录审核日志（审核员、时间、结果、备注）
   - 发送通知邮件给用户
   - 返回列表页
   - 显示成功提示："审核结果已提交！系统将自动发送通知邮件给用户。"

4. **提交失败**
   - 显示错误提示
   - 不关闭详情页
   - 保留已填写的内容

##### 3.3.2.5 审核历史

**功能描述**：展示该申请的历史审核记录

**展示内容**：
- 时间轴形式展示
- 每条记录包含：
  - 操作类型（如：用户提交认证申请、审核通过、审核驳回等）
  - 操作人（系统、审核员姓名等）
  - 操作时间
  - 操作备注（如驳回原因）

**示例记录**：
```
系统 · 2025-11-05 14:23
用户提交认证申请
```

**业务规则**：
- 按时间倒序排列
- 保留完整审核轨迹
- 支持展开查看详细信息

##### 3.3.2.6 返回列表

**功能描述**：提供返回列表页的导航

**交互方式**：
- 顶部返回按钮，带左箭头图标
- 点击返回到对应认证类型的列表页
- 保持列表页的筛选和分页状态

---

### 3.4 RWA综合审查模块

#### 3.4.1 个人/机构切换

**功能描述**：在RWA审查页面顶部提供个人认证和机构认证的切换

**功能要点**：
- Tab切换按钮
- 👤 个人认证 / 🏢 机构认证
- 选中状态：白色背景 + 蓝色文字 + 阴影
- 未选中状态：灰色文字
- 切换时更新下方表格内容

#### 3.4.2 RWA个人认证审查

**功能描述**：综合展示用户的所有个人认证项目进度和最终认证状态

**表格列**：

1. **账号**
   - 用户账号名称

2. **提交时间**
   - 格式：YYYY-MM-DD HH:mm

3. **KYC**
   - 状态标签（可点击）
   - 点击直接跳转到该用户的KYC认证详情页

4. **KYC补充信息**
   - 状态标签（可点击）
   - 点击直接跳转到该用户的KYC补充信息详情页

5. **合规审查**（原AML）
   - 状态标签（可点击）
   - 点击直接跳转到该用户的合规审查认证详情页

6. **住址证明**
   - 状态标签（可点击）
   - 点击直接跳转到该用户的住址证明认证详情页

7. **专业投资者认证**
   - 状态标签（可点击）
   - 点击直接跳转到该用户的专业投资者认证详情页

8. **风险测评结果**
   - 显示用户的风险等级：R1/R2/R3/R4/R5
   - 颜色编码：
     - R1：红色（保守型）
     - R2：橙色（稳健型）
     - R3：黄色（平衡型）
     - R4：绿色（进取型）
     - R5：蓝色（激进型）
     - 未测评：灰色
   - 风险测评数据来源于前台用户认证流程

9. **认证状态**
   - 系统自动计算，不可手动修改
   - 显示为状态标签（已通过/未通过/待审核）
   - 背景色随状态变化

**状态颜色规范**：
- 已通过：绿色背景 + 绿色文字
- 待审核：黄色背景 + 黄色文字
- 已驳回：红色背景 + 红色文字
- 需补充材料：蓝色背景 + 蓝色文字
- 未开始：灰色背景 + 灰色文字

**点击状态直接跳转详情页**：

- **交互优化**：点击任意认证项的状态标签，直接跳转到该用户在该认证类型下的详情页
- **跳转逻辑**：
  1. 获取用户账号
  2. 确定认证类型（KYC/KYC补充信息/合规审查/住址证明/专业投资者）
  3. 查找该用户在该认证类型下的申请记录
  4. 直接打开详情页（`viewDetail(item)`），无需经过列表页
  5. 如果找不到记录，则跳转到列表页并搜索该用户
- **适用范围**：所有认证类型（KYC、KYC补充信息、合规审查、住址证明、专业投资者）

**认证状态自动计算规则**：

系统根据各个认证环节的状态和风险测评结果自动计算最终认证状态：

1. **未通过**（红色）
   - 任何一个认证环节状态为`expired`（已过期）或`rejected`（已驳回）
   - 或者所有认证环节都通过，但风险测评等级低于R4（即R1/R2/R3）

2. **待审核**（黄色）
   - 任何一个认证环节状态为`pending`（待审核）、`supplement`（需补充材料）或`not_started`（未开始）
   - 或者所有认证环节都通过，但未完成风险测评

3. **已通过**（绿色）
   - 所有认证环节（KYC、KYC补充、合规审查、住址证明、专业投资者）状态都是`approved`（已通过）
   - 并且风险测评等级≥R4（即R4或R5）

**交互功能**：
- 点击任意认证项状态标签立即进入详情页，提高审核效率
- 认证状态自动计算，实时更新，无需手动操作

#### 3.4.3 RWA机构认证审查

**功能描述**：综合展示机构的所有认证项目进度和最终认证状态

**表格列**：

1. **账号**
   - 机构账号名称

2. **提交时间**
   - 格式：YYYY-MM-DD HH:mm

3. **KYB**
   - 状态标签（可点击）
   - 点击直接跳转到该机构的KYB认证详情页

4. **合规审核**（原AML企业）
   - 状态标签（可点击）
   - 点击直接跳转到该机构的合规审核认证详情页

5. **UBO**
   - 状态标签（可点击）
   - 点击直接跳转到该机构的UBO认证详情页

6. **账户操作人**
   - 状态标签（可点击）
   - **显示逻辑**：
     - 如果账户操作人与UBO人员相同（`isSameAsUBO: true`）：显示UBO的状态
     - 如果账户操作人是新添加的人员（`isSameAsUBO: false`）：显示账户操作人自己的认证状态
     - 如果未设置账户操作人：显示"未开始"（灰色）
   - **状态同步**：当账户操作人是UBO成员时，其状态与UBO状态保持同步
   - 点击直接跳转到该机构的账户操作人认证详情页

7. **专业投资者认证**
   - 状态标签（可点击）
   - 点击直接跳转到该机构的专业投资者认证详情页

8. **风险测评结果**
   - 显示机构的风险等级：R1/R2/R3/R4/R5
   - 颜色编码：
     - R1：红色（保守型）
     - R2：橙色（稳健型）
     - R3：黄色（平衡型）
     - R4：绿色（进取型）
     - R5：蓝色（激进型）
     - 未测评：灰色
   - 风险测评数据来源于前台机构认证流程

9. **认证状态**
   - 系统自动计算，不可手动修改
   - 显示为状态标签（已通过/未通过/待审核）
   - 背景色随状态变化

**点击状态直接跳转详情页**：

- **交互优化**：点击任意认证项的状态标签，直接跳转到该用户在该认证类型下的详情页
- **跳转逻辑**：
  1. 获取用户账号
  2. 确定认证类型（KYB/合规审核/UBO/账户操作人/专业投资者）
  3. 查找该用户在该认证类型下的申请记录
  4. 直接打开详情页（`viewDetail(item)`），无需经过列表页
  5. 如果找不到记录，则跳转到列表页并搜索该用户
- **适用范围**：所有认证类型（KYB、合规审核、UBO、账户操作人、专业投资者）

**UBO详情展示增强**：

当查看UBO认证详情时，系统会展示完整的UBO信息：

1. **有UBO人员的情况**
   - 显示绿色成功提示："✓ 已填写股东和实际控制人信息"
   - **25%以上股东列表**：
     - 姓名
     - 持股比例
     - "股东"标签（绿色）
   - **实际控制人列表**：
     - 姓名
     - 职位/角色
     - "实际控制人"标签（蓝色）

2. **无UBO人员的情况**
   - 显示橙色警告提示："⚠️ 机构声明无股东和实际控制人"
   - **原因说明**：
     - 展示机构填写的详细原因（如："本公司为特殊目的公司(SPV)，无实际股东和实际控制人..."）
   - **证明文件列表**：
     - 文件图标
     - 文件名称
     - 文件大小
     - 查看按钮（可预览或下载）

**认证状态自动计算规则**：

系统根据各个认证环节的状态和风险测评结果自动计算最终认证状态：

1. **未通过**（红色）
   - 任何一个认证环节状态为`expired`（已过期）或`rejected`（已驳回）
   - 或者所有认证环节都通过，但风险测评等级低于R4（即R1/R2/R3）

2. **待审核**（黄色）
   - 任何一个认证环节状态为`pending`（待审核）、`supplement`（需补充材料）或`not_started`（未开始）
   - 或者所有认证环节都通过，但未完成风险测评

3. **已通过**（绿色）
   - 所有认证环节（KYB、合规审核、UBO、账户操作人、专业投资者）状态都是`approved`（已通过）
   - 并且风险测评等级≥R4（即R4或R5）

**业务规则**：
- 自动汇总同一用户在各认证类型中的申请状态
- 实时更新各认证项的最新状态
- 最终认证状态由系统自动计算，无需人工干预
- 账户操作人状态需要根据是否为UBO人员判断展示来源

#### 3.4.4 筛选功能

**界面布局**：
- 第一行：用户账号、申请渠道、认证状态（3列网格布局）
- 第二行：开始时间、结束时间（2列网格布局）
- 响应式设计：移动端自适应为单列布局

**筛选条件**：

1. **用户账号搜索**
   - 支持模糊搜索
   - 输入框占位符："搜索用户账号、邮箱..."

2. **申请渠道筛选**
   - 下拉选择：全部渠道、钱包、US、RWA

3. **认证状态筛选**
   - 下拉选择：全部状态、已通过、已驳回、待审核、补充材料

4. **时间筛选**
   - 开始时间：日期选择器（date类型输入框）
   - 结束时间：日期选择器（date类型输入框）
   - 支持选择任意时间范围
   - 根据提交时间字段进行筛选

---

## 4. 非功能需求

### 4.1 性能要求

1. **响应时间**
   - 页面加载时间 ≤ 2秒
   - 列表查询响应时间 ≤ 1秒
   - 详情页加载时间 ≤ 1.5秒

2. **并发支持**
   - 支持至少50个并发用户
   - 高峰期不出现明显卡顿

3. **数据刷新**
   - 仪表盘数据每5分钟自动刷新
   - 列表数据支持手动刷新

### 4.2 安全要求

1. **操作验证**
   - 关键操作（审核通过/驳回）需要验证码
   - 验证码有效期5分钟
   - 连续3次验证失败提示错误

2. **数据安全**
   - 敏感数据加密传输（HTTPS）
   - 敏感信息脱敏显示（身份证号等）
   - 审核日志完整保留
   - 操作日志记录

### 4.3 可用性要求

1. **界面设计**
   - 界面简洁清晰，符合后台管理系统规范
   - 重要操作有明确的视觉反馈
   - 错误提示清晰易懂

2. **兼容性**
   - 支持Chrome、Firefox、Edge最新版本
   - 支持1920x1080及以上分辨率
   - 支持平板设备访问

3. **易用性**
   - 操作流程简洁，减少点击次数
   - 提供快捷操作功能
   - 提供操作帮助文档

### 4.4 可维护性要求

1. **日志记录**
   - 完整记录用户操作日志
   - 记录系统异常日志
   - 日志可查询和导出

2. **数据备份**
   - 数据每日自动备份
   - 支持数据恢复功能

3. **系统监控**
   - 监控系统运行状态
   - 异常情况及时告警

---

## 5. 业务规则

### 5.1 状态流转规则

#### 5.1.1 认证申请状态定义

| 状态代码 | 状态名称 | 描述 |
|---------|---------|------|
| pending | 待审核 | 用户已提交申请，等待审核员审核 |
| approved | 已通过 | 审核员审核通过 |
| rejected | 已驳回 | 审核员驳回申请 |
| supplement | 需补充材料 | 审核员要求用户补充材料 |
| supplement_submitted | 补充材料待审核 | 用户已提交补充材料，等待再次审核 |
| expired | 已过期 | 认证已超过有效期 |

#### 5.1.2 状态流转图

```
pending（待审核）
  ├─→ approved（已通过）
  ├─→ rejected（已驳回）
  └─→ supplement（需补充材料）
        └─→ supplement_submitted（补充材料待审核）
              ├─→ approved（已通过）
              ├─→ rejected（已驳回）
              └─→ supplement（需补充材料）[循环]

任意状态 → expired（已过期）[定时任务触发]
```

#### 5.1.3 状态流转规则

1. **待审核 → 已通过**
   - 条件：审核员审核材料无误
   - 操作：更新状态，发送通知邮件
   - 记录：审核员、审核时间、备注

2. **待审核 → 已驳回**
   - 条件：审核员发现材料不符合要求
   - 必填：驳回原因
   - 操作：更新状态，发送通知邮件（含驳回原因）
   - 记录：审核员、审核时间、驳回原因

3. **待审核 → 需补充材料**
   - 条件：审核员发现材料不完整
   - 必填：补充材料说明
   - 操作：更新状态，发送通知邮件（含补充说明）
   - 记录：审核员、审核时间、补充说明

4. **需补充材料 → 补充材料待审核**
   - 条件：用户上传补充材料
   - 操作：自动更新状态，通知审核员
   - 记录：用户、提交时间、补充文件列表

5. **任意状态 → 已过期**
   - 条件：认证超过有效期（如90天）
   - 触发：定时任务自动检查
   - 操作：批量更新过期申请状态

### 5.2 审核规则

#### 5.2.1 审核验证规则

1. **验证码验证**
   - 审核操作必须输入6位数字验证码
   - 验证码由身份验证器APP生成
   - 验证码5分钟内有效
   - 连续3次验证失败显示错误提示

2. **必填项验证**
   - 驳回操作必须填写驳回原因
   - 驳回原因不少于10个字符
   - 补充材料说明建议填写（可选）

#### 5.2.2 审核时效规则

1. **审核时限**
   - 普通申请：3个工作日内完成审核
   - 补充材料提交后：2个工作日内完成审核
   - 高优先级申请：1个工作日内完成审核

2. **过期规则**
   - 认证有效期：90天（可配置）
   - 过期前7天发送提醒通知
   - 过期后自动标记为"已过期"状态

3. **催办规则**
   - 待审核超过2天自动提醒审核员
   - 待审核超过5天标记为"即将过期"
   - 发送催办通知给审核员和管理员

### 5.3 通知规则

#### 5.3.1 用户通知

1. **审核通过通知**
   - 发送时机：审核员审核通过后
   - 通知渠道：邮件 + 站内信
   - 内容：认证类型、审核结果、有效期

2. **审核驳回通知**
   - 发送时机：审核员驳回申请后
   - 通知渠道：邮件 + 站内信
   - 内容：认证类型、驳回原因、重新申请指引

3. **补充材料通知**
   - 发送时机：审核员要求补充材料后
   - 通知渠道：邮件 + 站内信
   - 内容：需补充的材料清单、提交指引、截止日期

4. **即将过期通知**
   - 发送时机：认证过期前7天
   - 通知渠道：邮件 + 站内信
   - 内容：过期时间、续期指引

#### 5.3.2 审核员通知

1. **新申请通知**
   - 发送时机：用户提交新申请后
   - 通知渠道：站内信 + 桌面通知（可选）
   - 内容：申请类型、用户账号、提交时间

2. **补充材料提交通知**
   - 发送时机：用户提交补充材料后
   - 通知渠道：站内信 + 桌面通知（可选）
   - 内容：用户账号、补充文件列表

3. **催办通知**
   - 发送时机：待审核超过规定时间
   - 通知渠道：邮件 + 站内信
   - 内容：待审核申请列表、待审核天数

### 5.4 数据统计规则

#### 5.4.1 统计维度

1. **时间维度**
   - 今日、本周、本月、本季度、本年度
   - 自定义时间范围（通过开始时间和结束时间选择器）

2. **认证类型维度**
   - 按认证类型分类统计
   - 按申请渠道分类统计

3. **状态维度**
   - 按审核状态分类统计
   - 按最终认证状态分类统计

#### 5.4.2 统计指标

1. **数量指标**
   - 总申请数
   - 待审核数
   - 已审核数
   - 通过数
   - 驳回数
   - 补充材料数
   - 过期数

2. **比率指标**
   - 通过率 = 已通过数 / 已审核数
   - 驳回率 = 已驳回数 / 已审核数
   - 补充率 = 需补充材料数 / 已审核数

3. **时效指标**
   - 平均审核时长
   - 待审核超时数量
   - 即将过期数量

---

## 6. 数据字典

### 6.1 认证申请表（certification_applications）

| 字段名 | 数据类型 | 长度 | 必填 | 说明 |
|-------|---------|------|-----|------|
| id | VARCHAR | 50 | 是 | 主键，申请ID |
| user_account | VARCHAR | 100 | 是 | 用户账号 |
| email | VARCHAR | 100 | 否 | 用户邮箱 |
| contact | VARCHAR | 50 | 否 | 联系方式 |
| channel | VARCHAR | 20 | 是 | 申请渠道：钱包/US/RWA |
| type | VARCHAR | 50 | 是 | 认证类型 |
| status | VARCHAR | 30 | 是 | 状态 |
| submit_time | DATETIME | - | 是 | 提交时间 |
| review_time | DATETIME | - | 否 | 审核时间 |
| reviewer | VARCHAR | 50 | 否 | 审核员 |
| details | JSON | - | 是 | 详细数据 |
| files | JSON | - | 否 | 上传文件列表 |
| supplement_reason | TEXT | - | 否 | 补充材料说明 |
| supplement_files | JSON | - | 否 | 补充文件列表 |
| reject_reason | TEXT | - | 否 | 驳回原因 |
| expire_time | DATETIME | - | 否 | 过期时间 |
| created_at | DATETIME | - | 是 | 创建时间 |
| updated_at | DATETIME | - | 是 | 更新时间 |

### 6.2 审核日志表（review_logs）

| 字段名 | 数据类型 | 长度 | 必填 | 说明 |
|-------|---------|------|-----|------|
| id | INT | - | 是 | 主键，自增 |
| application_id | VARCHAR | 50 | 是 | 申请ID |
| action | VARCHAR | 50 | 是 | 操作类型 |
| operator | VARCHAR | 50 | 是 | 操作人 |
| operator_type | VARCHAR | 20 | 是 | 操作人类型：system/reviewer |
| old_status | VARCHAR | 30 | 否 | 原状态 |
| new_status | VARCHAR | 30 | 是 | 新状态 |
| comment | TEXT | - | 否 | 备注 |
| verification_code | VARCHAR | 10 | 否 | 验证码（加密存储） |
| ip_address | VARCHAR | 50 | 否 | IP地址 |
| created_at | DATETIME | - | 是 | 创建时间 |

### 6.3 RWA综合审查表（rwa_reviews）

| 字段名 | 数据类型 | 长度 | 必填 | 说明 |
|-------|---------|------|-----|------|
| id | INT | - | 是 | 主键，自增 |
| user_account | VARCHAR | 100 | 是 | 用户账号 |
| type | VARCHAR | 20 | 是 | 类型：personal/institutional |
| submit_time | DATETIME | - | 是 | 提交时间 |
| kyc_status | VARCHAR | 30 | 否 | KYC状态 |
| kyc_supplement_status | VARCHAR | 30 | 否 | KYC补充信息状态 |
| kyb_status | VARCHAR | 30 | 否 | KYB状态 |
| ubo_status | VARCHAR | 30 | 否 | UBO状态 |
| ubo_details | JSON | - | 否 | UBO详细信息（仅机构认证） |
| operator_status | VARCHAR | 30 | 否 | 账户操作人状态（仅机构认证） |
| operator_is_same_as_ubo | BOOLEAN | - | 否 | 账户操作人是否为UBO成员（仅机构认证） |
| operator_name | VARCHAR | 100 | 否 | 账户操作人姓名（仅机构认证） |
| compliance_status | VARCHAR | 30 | 否 | 合规审核/审查状态（原aml_status） |
| address_status | VARCHAR | 30 | 否 | 住址证明状态（仅个人认证） |
| professional_status | VARCHAR | 30 | 否 | 专业投资者状态 |
| risk_level | VARCHAR | 10 | 否 | 风险测评等级（R1/R2/R3/R4/R5） |
| certification_status | VARCHAR | 30 | 是 | 最终认证状态（系统自动计算） |
| created_at | DATETIME | - | 是 | 创建时间 |
| updated_at | DATETIME | - | 是 | 更新时间 |

**ubo_details JSON 结构**：

```json
{
  "hasPersonnel": true/false,
  "shareholders": [
    {
      "name": "股东姓名",
      "percentage": "持股比例"
    }
  ],
  "actualControllers": [
    {
      "name": "实际控制人姓名",
      "position": "职位/角色"
    }
  ],
  "reason": "无UBO人员的原因说明（仅hasPersonnel为false时）",
  "proofFiles": [
    {
      "name": "文件名",
      "size": "文件大小"
    }
  ]
}
```

---

## 7. 界面原型说明

### 7.1 整体布局

系统采用左侧边栏 + 右侧主内容区的经典后台布局：

```
┌─────────────┬───────────────────────────────────┐
│             │  顶部栏（面包屑、通知、用户信息）    │
│   侧边栏     ├───────────────────────────────────┤
│   导航菜单   │                                   │
│             │        主内容区                    │
│             │                                   │
│             │                                   │
└─────────────┴───────────────────────────────────┘
```

### 7.2 侧边栏

**宽度**：256px（固定）

**背景色**：白色（#FFFFFF）

**内容区域**：

1. **头部区域**（边框底部）
   - 系统标题："认证管理系统"
   - 副标题："Admin Dashboard"

2. **导航菜单区域**
   - 仪表盘（📊图标）
   - 认证管理分组
     - KYC补充信息（👤）+ 待审核数量徽章
     - KYB机构认证（🏢）+ 待审核数量徽章
     - UBO认证（👥）+ 待审核数量徽章
     - 合规审查（个人）（🔍）+ 待审核数量徽章
     - 合规审核（企业）（🔎）+ 待审核数量徽章
     - 账户操作人（机构）（👔）+ 待审核数量徽章
     - 专业投资者(个人)（💼）+ 待审核数量徽章
     - 专业投资者(机构)（🏛️）+ 待审核数量徽章
   - 综合审查分组
     - RWA审查（🔍）- 点击状态直接进入详情

3. **底部用户信息**
   - 头像（首字母圆形）
   - 用户名
   - 用户邮箱

**待审核数量徽章**：
- 显示位置：菜单项右侧浮动
- 显示内容：待审核（pending）和补充材料待审核（supplement_submitted）状态的申请总数
- 样式规范：
  - 背景色：浅蓝色（#DBEAFE）
  - 文字颜色：蓝色（#2563EB）
  - 圆角：完全圆角（rounded-full）
  - 内边距：上下 2px，左右 8px
  - 字体大小：12px
- 数据更新：实时统计，自动刷新
- 显示规则：
  - 有待审核数据时显示数字
  - 数量为 0 时仍然显示 0
  - 数据加载失败时显示 0

**交互效果**：
- 菜单项悬停：浅蓝色背景（#EBF8FF）
- 菜单项激活：蓝色背景（#3182CE）+ 白色文字
- 徽章始终可见，不受菜单状态影响

### 7.3 顶部栏

**高度**：72px

**背景色**：白色（#FFFFFF）

**内容布局**：

**左侧**：
- 页面标题（大号粗体）
- 页面副标题（小号灰色）

**右侧**：
- 通知图标（带红点提示）
- 用户信息
  - 用户名
  - 角色标识

### 7.4 主内容区

**背景色**：浅灰色（#F7FAFC）

**内边距**：32px

**内容展示**：
- 根据左侧菜单选中项展示对应页面
- 支持页面切换动画过渡
- 响应式布局

### 7.5 颜色规范

#### 7.5.1 主色调

- **主色**：蓝色（#3182CE）
- **辅助色**：浅蓝色（#EBF8FF）
- **背景色**：浅灰色（#F7FAFC）

#### 7.5.2 状态颜色

- **待审核**：黄色（#F59E0B）
- **已通过**：绿色（#10B981）
- **已驳回**：红色（#EF4444）
- **需补充材料**：蓝色（#3B82F6）
- **补充材料待审核**：橙色（#F97316）
- **已过期**：灰色（#6B7280）

#### 7.5.3 渠道颜色

- **钱包**：紫色（#8B5CF6）
- **US**：蓝色（#3B82F6）
- **RWA**：绿色（#10B981）

### 7.6 字体规范

- **标题字体**：PingFang SC、微软雅黑、Arial
- **正文字体**：PingFang SC、微软雅黑、Arial
- **等宽字体**：Menlo、Monaco、Courier New

**字号规范**：
- 大标题：24px
- 中标题：18px
- 小标题：16px
- 正文：14px
- 辅助文字：12px

### 7.7 间距规范

- **组件间距**：16px、24px、32px
- **内边距**：12px、16px、24px
- **卡片圆角**：8px
- **按钮圆角**：6px

### 7.8 响应式设计

**断点设置**：
- 桌面端：≥1920px
- 笔记本：1366px - 1919px
- 平板：768px - 1365px
- 移动端：<768px

**适配规则**：
- 桌面端：完整4列卡片布局
- 笔记本：3列卡片布局
- 平板：2列卡片布局 + 侧边栏可折叠
- 移动端：1列卡片布局 + 侧边栏抽屉式

---

## 8. 附录

### 8.1 技术栈建议

**前端**：
- 框架：Vue.js 3.x / React 18.x
- UI组件库：Element Plus / Ant Design
- 状态管理：Pinia / Redux
- 路由：Vue Router / React Router
- HTTP客户端：Axios
- 图表库：ECharts / Chart.js

**后端**：
- 语言：Node.js / Java / Python
- 框架：Express / Spring Boot / FastAPI
- 数据库：MySQL / PostgreSQL
- 缓存：Redis
- 消息队列：RabbitMQ / Kafka

**其他**：
- 身份验证：验证码认证
- 文件存储：OSS / S3
- 日志：ELK Stack
- 监控：Prometheus + Grafana

### 8.2 API接口清单

#### 8.2.1 认证申请相关

- `GET /api/applications` - 获取申请列表
- `GET /api/applications/:id` - 获取申请详情
- `POST /api/applications/:id/review` - 提交审核结果
- `POST /api/applications/:id/quick-approve` - 快速通过
- `POST /api/applications/:id/quick-reject` - 快速驳回
- `GET /api/applications/:id/logs` - 获取审核日志

#### 8.2.2 仪表盘相关

- `GET /api/dashboard/statistics` - 获取统计数据
- `GET /api/dashboard/pending` - 获取待审核列表
- `GET /api/dashboard/distribution` - 获取认证类型分布

#### 8.2.3 RWA审查相关

- `GET /api/rwa/personal` - 获取个人认证审查列表
- `GET /api/rwa/institutional` - 获取机构认证审查列表
- `PUT /api/rwa/:id/status` - 更新最终认证状态

### 8.3 错误码定义

| 错误码 | 说明 |
|-------|------|
| 200 | 成功 |
| 400 | 请求参数错误 |
| 401 | 未授权 |
| 403 | 无权限 |
| 404 | 资源不存在 |
| 422 | 验证失败 |
| 429 | 请求过于频繁 |
| 500 | 服务器内部错误 |
| 1001 | 验证码错误 |
| 1002 | 验证码已过期 |
| 2001 | 申请不存在 |
| 2002 | 申请状态不允许该操作 |
| 2003 | 驳回原因不能为空 |

### 8.4 版本记录

| 版本号 | 更新日期 | 更新内容 | 更新人 |
|-------|---------|---------|--------|
| V1.0 | 2025-11-06 | 初始版本，完成所有模块需求文档 | AI |
| V1.1 | 2025-11-06 | 1. 优化仪表盘"近期待审核"交互：整卡可点击，直接进入详情页<br>2. RWA审查新增账户操作人字段（仅机构认证）<br>3. 账户操作人状态显示逻辑优化：根据是否为UBO成员显示不同状态<br>4. RWA审查列表点击状态直接跳转详情页，无需二次点击<br>5. UBO详情展示增强：区分有/无UBO人员情况，展示股东、实际控制人或原因说明和证明文件<br>6. 术语更新：AML改为合规审核/审查<br>7. 数据字典新增ubo_details、operator相关字段 | AI |
| V1.2 | 2025-11-07 | 1. 删除独立的风险测评模块（个人和机构）<br>2. RWA审查（个人和机构）新增"风险测评结果"字段，显示R1-R5等级<br>3. 认证状态改为系统自动计算，不可手动修改<br>4. 新增认证状态自动计算规则：<br>   - 未通过：任一环节过期/驳回，或全通过但风险等级<R4<br>   - 待审核：任一环节待审核/补充/未开始，或未完成风险测评<br>   - 已通过：所有环节通过且风险等级≥R4<br>5. 数据字典新增risk_level字段，标注certification_status为系统自动计算<br>6. 仪表盘删除风险测评统计卡片<br>7. 更新功能架构图，明确风险测评结果在RWA审查中展示 | AI |

---

**文档结束**

