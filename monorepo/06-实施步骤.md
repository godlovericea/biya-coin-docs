# ğŸš€ å®æ–½æ­¥éª¤

> **æ ¸å¿ƒå†…å®¹**: å°† biya-helix-app è¿ç§»åˆ° Monorepo çš„å®Œæ•´æ­¥éª¤  
> **ç›®æ ‡**: åˆ†é˜¶æ®µã€ä½é£é™©åœ°å®Œæˆè¿ç§»  
> **é¢„è®¡æ—¶é—´**: 2-3 å¤©  
> **æ›´æ–°æ—¶é—´**: 2025-10-31

---

## ğŸ“– ç›®å½•

1. [å‡†å¤‡å·¥ä½œ](#å‡†å¤‡å·¥ä½œ)
2. [é˜¶æ®µ 1ï¼šåˆ›å»º Monorepo ç»“æ„](#é˜¶æ®µ-1åˆ›å»º-monorepo-ç»“æ„)
3. [é˜¶æ®µ 2ï¼šåˆ›å»ºå…±äº«åŒ…](#é˜¶æ®µ-2åˆ›å»ºå…±äº«åŒ…)
4. [é˜¶æ®µ 3ï¼šè¿ç§»ä¸»åº”ç”¨](#é˜¶æ®µ-3è¿ç§»ä¸»åº”ç”¨)
5. [é˜¶æ®µ 4ï¼šåˆ†ç¦» Bridge åº”ç”¨](#é˜¶æ®µ-4åˆ†ç¦»-bridge-åº”ç”¨)
6. [é˜¶æ®µ 5ï¼šé…ç½®å’Œä¼˜åŒ–](#é˜¶æ®µ-5é…ç½®å’Œä¼˜åŒ–)
7. [é˜¶æ®µ 6ï¼šæµ‹è¯•å’ŒéªŒè¯](#é˜¶æ®µ-6æµ‹è¯•å’ŒéªŒè¯)

---

## ğŸ“‹ å‡†å¤‡å·¥ä½œ

### 1. å¤‡ä»½ç°æœ‰ä»£ç 

```bash
# åœ¨ D:\rwa\biya-coin ç›®å½•ä¸‹
cd D:\rwa\biya-coin

# åˆ›å»ºå¤‡ä»½åˆ†æ”¯
git checkout -b backup-before-monorepo
git add .
git commit -m "Backup before Monorepo migration"

# åˆ›å»ºè¿ç§»åˆ†æ”¯
git checkout -b feature/monorepo-migration
```

---

### 2. å®‰è£…å·¥å…·

```bash
# å¦‚æœä½¿ç”¨ pnpmï¼ˆæ¨èï¼‰
npm install -g pnpm

# æˆ–è€…ç¡®ä¿ npm æ˜¯æœ€æ–°ç‰ˆæœ¬
npm install -g npm@latest

# éªŒè¯ç‰ˆæœ¬
pnpm --version  # æˆ– npm --version
node --version  # åº”è¯¥ >= 18.0.0
```

---

### 3. é¡¹ç›®çŠ¶æ€æ£€æŸ¥

```bash
cd biya-helix-app

# ç¡®ä¿å½“å‰é¡¹ç›®å¯ä»¥æ­£å¸¸è¿è¡Œ
npm install
npm run dev

# ç¡®ä¿æ²¡æœ‰ TypeScript é”™è¯¯
npm run type-check

# ç¡®ä¿æ„å»ºæˆåŠŸ
npm run build
```

---

## ğŸ—ï¸ é˜¶æ®µ 1ï¼šåˆ›å»º Monorepo ç»“æ„

### æ­¥éª¤ 1.1ï¼šåˆ›å»ºæ ¹ç›®å½•ç»“æ„

```bash
# åœ¨ D:\rwa\biya-coin ç›®å½•ä¸‹
cd D:\rwa\biya-coin

# åˆ›å»ºç›®å½•
mkdir -p apps
mkdir -p packages/shared
mkdir -p packages/theme
mkdir -p packages/i18n
mkdir -p packages/wallet
mkdir -p packages/auth
```

---

### æ­¥éª¤ 1.2ï¼šåˆ›å»ºæ ¹ package.json

```bash
# åˆ›å»ºæ ¹ package.json
cd D:\rwa\biya-coin
```

åˆ›å»º `package.json`:

```json
{
  "name": "biya-coin",
  "version": "1.0.0",
  "private": true,
  "scripts": {
    "dev": "npm run dev --workspaces --if-present",
    "dev:helix": "npm run dev --workspace=apps/helix",
    "dev:bridge": "npm run dev --workspace=apps/bridge",
    "build": "npm run build --workspaces --if-present",
    "build:helix": "npm run build --workspace=apps/helix",
    "build:bridge": "npm run build --workspace=apps/bridge",
    "start:helix": "npm run start --workspace=apps/helix",
    "start:bridge": "npm run start --workspace=apps/bridge",
    "lint": "npm run lint --workspaces --if-present",
    "type-check": "npm run type-check --workspaces --if-present",
    "clean": "rimraf node_modules apps/*/node_modules packages/*/node_modules",
    "clean:build": "rimraf apps/*/.next packages/*/dist",
    "postinstall": "rimraf packages/theme/node_modules packages/wallet/node_modules"
  },
  "dependencies": {
    "lucide-react": "^0.548.0",
    "zustand": "^5.0.8"
  },
  "devDependencies": {
    "@types/node": "^20.0.0",
    "@types/react": "^19.0.0",
    "@types/react-dom": "^19.0.0",
    "typescript": "^5.0.0",
    "eslint": "^9.0.0",
    "prettier": "^3.6.2",
    "rimraf": "^6.0.1"
  },
  "engines": {
    "node": ">=18.0.0",
    "npm": ">=9.0.0"
  }
}
```


åˆ›å»º `pnpm-workspace.yaml`

```yaml
packages:
  - 'apps/*'
  - 'packages/*'
```

### æ­¥éª¤ 1.3ï¼šåˆ›å»ºæ ¹ tsconfig.json

```json
{
  "compilerOptions": {
    "target": "ES2022",
    "lib": ["ES2022", "DOM", "DOM.Iterable"],
    "module": "ESNext",
    "moduleResolution": "bundler",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "jsx": "preserve",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "incremental": true,
    "baseUrl": ".",
    "paths": {
      "@biya/shared": ["./packages/shared"],
      "@biya/shared/*": ["./packages/shared/*"],
      "@biya/theme": ["./packages/theme"],
      "@biya/theme/*": ["./packages/theme/*"],
      "@biya/i18n": ["./packages/i18n"],
      "@biya/i18n/*": ["./packages/i18n/*"],
      "@biya/wallet": ["./packages/wallet"],
      "@biya/wallet/*": ["./packages/wallet/*"],
      "@biya/auth": ["./packages/auth"],
      "@biya/auth/*": ["./packages/auth/*"]
    }
  },
  "include": ["apps/**/*", "packages/**/*"],
  "exclude": ["node_modules", ".next", "dist"]
}
```

---

### æ­¥éª¤ 1.4ï¼šæ›´æ–° .gitignore

```gitignore
# ä¾èµ–
node_modules/
.pnp
.pnp.js

# æ„å»º
.next/
out/
dist/
build/

# ç¼“å­˜
.turbo/
.cache/

# ç¯å¢ƒå˜é‡
.env
.env*.local

# è°ƒè¯•
npm-debug.log*
yarn-debug.log*
pnpm-debug.log*

# IDE
.vscode/
.idea/
*.swp

# OS
.DS_Store
Thumbs.db

# TypeScript
*.tsbuildinfo

# æµ‹è¯•
coverage/

# Vercel
.vercel
```

---

## ğŸ“¦ é˜¶æ®µ 2ï¼šåˆ›å»ºå…±äº«åŒ…

### æ­¥éª¤ 2.1ï¼šåˆ›å»º @biya/shared

```bash
cd D:\rwa\biya-coin\packages\shared
```

**åˆ›å»º package.json**:

```json
{
  "name": "@biya/shared",
  "version": "1.0.0",
  "private": true,
  "main": "./index.ts",
  "types": "./index.ts",
  "exports": {
    ".": "./index.ts",
    "./components": "./components/index.ts",
    "./hooks": "./hooks/index.ts",
    "./utils": "./utils/index.ts",
    "./types": "./types/index.ts"
  },
  "scripts": {
    "type-check": "tsc --noEmit"
  },
  "peerDependencies": {
    "react": "^19.0.0",
    "react-dom": "^19.0.0"
  },
  "dependencies": {
    "clsx": "^2.1.1",
    "tailwind-merge": "^3.3.1",
  }
}
```

**åˆ›å»ºç›®å½•ç»“æ„**:

```bash
mkdir -p components/ui
mkdir -p components/layout
mkdir -p hooks
mkdir -p utils
mkdir -p types
```

**åˆ›å»º components/ui/Button.tsx**:

```typescript
import { forwardRef } from 'react'
import { cn } from '../../utils/cn'

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: 'default' | 'primary' | 'secondary' | 'outline' | 'ghost' | 'destructive'
  size?: 'sm' | 'md' | 'lg'
  isLoading?: boolean
}

const Button = forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant = 'default', size = 'md', isLoading, children, disabled, ...props }, ref) => {
    return (
      <button
        ref={ref}
        className={cn(
          'inline-flex items-center justify-center rounded-lg font-medium transition-colors',
          'focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2',
          'disabled:pointer-events-none disabled:opacity-50',
          {
            'h-8 px-3 text-sm': size === 'sm',
            'h-10 px-4 text-base': size === 'md',
            'h-12 px-6 text-lg': size === 'lg',
          },
          {
            'bg-gray-900 text-white hover:bg-gray-800 dark:bg-gray-50 dark:text-gray-900': variant === 'default',
            'bg-blue-600 text-white hover:bg-blue-700': variant === 'primary',
            'bg-gray-200 text-gray-900 hover:bg-gray-300': variant === 'secondary',
            'border border-gray-300 bg-transparent hover:bg-gray-100': variant === 'outline',
            'hover:bg-gray-100 dark:hover:bg-gray-800': variant === 'ghost',
            'bg-red-600 text-white hover:bg-red-700': variant === 'destructive',
          },
          className
        )}
        disabled={disabled || isLoading}
        {...props}
      >
        {isLoading && (
          <svg className="mr-2 h-4 w-4 animate-spin" viewBox="0 0 24 24">
            <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4" fill="none" />
            <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" />
          </svg>
        )}
        {children}
      </button>
    )
  }
)

Button.displayName = 'Button'

export { Button }
```

**åˆ›å»º utils/cn.ts**:

```typescript
import { type ClassValue, clsx } from 'clsx'
import { twMerge } from 'tailwind-merge'

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}
```

**åˆ›å»º hooks/useDebounce.ts**:

```typescript
import { useEffect, useState } from 'react'

export function useDebounce<T>(value: T, delay: number = 500): T {
  const [debouncedValue, setDebouncedValue] = useState<T>(value)

  useEffect(() => {
    const timer = setTimeout(() => {
      setDebouncedValue(value)
    }, delay)

    return () => {
      clearTimeout(timer)
    }
  }, [value, delay])

  return debouncedValue
}
```

**åˆ›å»º index.ts**:

```typescript
// ç»„ä»¶
export * from './components/ui/Button'

// Hooks
export * from './hooks/useDebounce'

// å·¥å…·
export * from './utils/cn'
```

**åˆ›å»º tsconfig.json**:

```json
{
  "extends": "../../tsconfig.json",
  "compilerOptions": {
    "baseUrl": ".",
    "composite": true,
    "declaration": true,
    "declarationMap": true
  },
  "include": ["**/*.ts", "**/*.tsx"],
  "exclude": ["node_modules", "dist"]
}
```

---

### æ­¥éª¤ 2.2ï¼šåˆ›å»º @biya/theme

```bash
cd D:\rwa\biya-coin\packages\theme
```

**åˆ›å»º package.json**:

```json
{
  "name": "@biya/theme",
  "version": "1.0.0",
  "private": true,
  "main": "./index.ts",
  "types": "./index.ts",
  "exports": {
    ".": "./index.ts",
    "./store": "./store/theme-store.ts",
    "./components": "./components/index.ts"
  },
  "peerDependencies": {
    "react": "^19.0.0"
  },
  "dependencies": {
  }
}
```

**åˆ›å»ºç›®å½•**:

```bash
mkdir -p store
mkdir -p components
mkdir -p hooks
```

**åˆ›å»º store/theme-store.ts**:

```typescript
import { create } from 'zustand'
import { persist, createJSONStorage } from 'zustand/middleware'

export type Theme = 'light' | 'dark' | 'system'

interface ThemeState {
  theme: Theme
  isDark: boolean
  setTheme: (theme: Theme) => void
  toggleTheme: () => void
}

export const useThemeStore = create<ThemeState>()(
  persist(
    (set, get) => ({
      theme: 'system',
      isDark: false,
      
      setTheme: (theme) => {
        const root = document.documentElement
        const isDark = theme === 'dark' || 
          (theme === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches)
        
        root.classList.toggle('dark', isDark)
        set({ theme, isDark })
      },
      
      toggleTheme: () => {
        const current = get().theme
        const newTheme = current === 'dark' ? 'light' : 'dark'
        get().setTheme(newTheme)
      },
    }),
    {
      name: 'biya-theme-storage',
      storage: createJSONStorage(() => localStorage),
    }
  )
)

export const selectTheme = (state: ThemeState) => state.theme
export const selectIsDark = (state: ThemeState) => state.isDark
```

**åˆ›å»º components/ThemeToggle.tsx**:

```typescript
'use client'

import { Moon, Sun } from 'lucide-react'
import { useThemeStore } from '../store/theme-store'

export function ThemeToggle() {
  const { isDark, toggleTheme } = useThemeStore()

  return (
    <button
      onClick={toggleTheme}
      className="rounded-lg p-2 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"
      aria-label="Toggle theme"
    >
      {isDark ? (
        <Sun className="h-5 w-5 text-gray-600 dark:text-gray-400" />
      ) : (
        <Moon className="h-5 w-5 text-gray-600 dark:text-gray-400" />
      )}
    </button>
  )
}
```

**åˆ›å»º components/ThemeScript.tsx**:

```typescript
export function ThemeScript() {
  const themeScript = `
    (function() {
      const theme = localStorage.getItem('biya-theme-storage')
      if (theme) {
        const { state } = JSON.parse(theme)
        const isDark = state.theme === 'dark' || 
          (state.theme === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches)
        
        if (isDark) {
          document.documentElement.classList.add('dark')
        }
      }
    })()
  `

  return (
    <script
      dangerouslySetInnerHTML={{ __html: themeScript }}
      suppressHydrationWarning
    />
  )
}
```

**åˆ›å»º index.ts**:

```typescript
export * from './store/theme-store'
export * from './components/ThemeToggle'
export * from './components/ThemeScript'
```

**åˆ›å»º tsconfig.json**:

```json
{
  "extends": "../../tsconfig.json",
  "compilerOptions": {
    "baseUrl": ".",
    "composite": true,
    "declaration": true
  },
  "include": ["**/*.ts", "**/*.tsx"],
  "exclude": ["node_modules"]
}
```

---

### æ­¥éª¤ 2.3ï¼šåˆ›å»º @biya/wallet

```bash
cd D:\rwa\biya-coin\packages\wallet
```

**åˆ›å»º package.json**:

```json
{
  "name": "@biya/wallet",
  "version": "1.0.0",
  "private": true,
  "main": "./index.ts",
  "types": "./index.ts",
  "peerDependencies": {
    "react": "^19.0.0"
  },
  "dependencies": {
  }
}
```

**åˆ›å»ºç›®å½•**:

```bash
mkdir -p store
mkdir -p components
```

**åˆ›å»º store/wallet-store.ts**:

```typescript
import { create } from 'zustand'
import { persist, createJSONStorage } from 'zustand/middleware'

interface WalletState {
  address: string | null
  injectiveAddress: string | null
  chainId: number | null
  isConnected: boolean
  isConnecting: boolean
  balance: string | null
  
  setAddress: (address: string | null) => void
  setInjectiveAddress: (address: string | null) => void
  setChainId: (chainId: number | null) => void
  setConnected: (connected: boolean) => void
  setConnecting: (connecting: boolean) => void
  setBalance: (balance: string | null) => void
  disconnect: () => void
  reset: () => void
}

export const useWalletStore = create<WalletState>()(
  persist(
    (set) => ({
      address: null,
      injectiveAddress: null,
      chainId: null,
      isConnected: false,
      isConnecting: false,
      balance: null,
      
      setAddress: (address) => set({ address, isConnected: !!address }),
      setInjectiveAddress: (injectiveAddress) => set({ injectiveAddress }),
      setChainId: (chainId) => set({ chainId }),
      setConnected: (isConnected) => set({ isConnected }),
      setConnecting: (isConnecting) => set({ isConnecting }),
      setBalance: (balance) => set({ balance }),
      
      disconnect: () => set({
        address: null,
        injectiveAddress: null,
        isConnected: false,
        balance: null,
      }),
      
      reset: () => set({
        address: null,
        injectiveAddress: null,
        chainId: null,
        isConnected: false,
        isConnecting: false,
        balance: null,
      }),
    }),
    {
      name: 'biya-wallet-storage',
      storage: createJSONStorage(() => localStorage),
      partialize: (state) => ({
        address: state.address,
        injectiveAddress: state.injectiveAddress,
        chainId: state.chainId,
      }),
    }
  )
)

export const selectAddress = (state: WalletState) => state.address
export const selectIsConnected = (state: WalletState) => state.isConnected
```

**åˆ›å»º index.ts**:

```typescript
export * from './store/wallet-store'
```

**åˆ›å»º tsconfig.json**ï¼ˆåŒä¸Šï¼‰

---

### æ­¥éª¤ 2.4ï¼šå®‰è£…å…±äº«åŒ…ä¾èµ–

```bash
cd D:\rwa\biya-coin

# å®‰è£…æ‰€æœ‰ä¾èµ–(ä¼˜å…ˆpnpm)
pnpm install

# æˆ–ä½¿ç”¨ npm
npm install
```

---

## ğŸ  é˜¶æ®µ 3ï¼šè¿ç§»ä¸»åº”ç”¨

### æ­¥éª¤ 3.1ï¼šç§»åŠ¨ biya-helix-app åˆ° apps/helix

```bash
cd D:\rwa\biya-coin

# å¤åˆ¶æ•´ä¸ªé¡¹ç›®
cp -r biya-helix-app apps/helix

# æˆ–è€…ä½¿ç”¨ PowerShell
# Copy-Item -Path "biya-helix-app" -Destination "apps\helix" -Recurse
```

---

### æ­¥éª¤ 3.2ï¼šæ›´æ–° apps/helix/package.json

ä¿®æ”¹ `name` å’Œæ·»åŠ å…±äº«åŒ…ä¾èµ–:

```json
{
  "name": "@biya/helix",
  "version": "1.0.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint",
    "type-check": "tsc --noEmit"
  },
  "dependencies": {
    "@biya/shared": "*",
    "@biya/theme": "*",
    "@biya/i18n": "*",
    "next": "15.5.4",
    "react": "19.1.0",
    "react-dom": "19.1.0",
    "next-intl": "^4.4.0",
    "zustand": "^5.0.8",
    "clsx": "^2.1.1",
    "tailwind-merge": "^3.3.1",
    "lucide-react": "^0.548.0"
  },
  "devDependencies": {
    "@types/node": "^20",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "typescript": "^5",
    "eslint": "^9",
    "eslint-config-next": "15.5.4",
    "@tailwindcss/postcss": "^4",
    "tailwindcss": "^4"
  }
}
```

---

### æ­¥éª¤ 3.3ï¼šæ›´æ–° apps/helix/tsconfig.json

```json
{
  "extends": "../../tsconfig.json",
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["./*"],
      "@biya/shared": ["../../packages/shared"],
      "@biya/theme": ["../../packages/theme"],
      "@biya/i18n": ["../../packages/i18n"]
    },
    "plugins": [
      {
        "name": "next"
      }
    ]
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx",
    ".next/types/**/*.ts"
  ],
  "exclude": [
    "node_modules"
  ]
}
```

---

### æ­¥éª¤ 3.4ï¼šè¿ç§»é€šç”¨ç»„ä»¶åˆ° @biya/shared

```bash
# ä» apps/helix/components è¿ç§»åˆ° packages/shared/components

# ä¾‹å¦‚ï¼Œè¿ç§» Button.tsx
# å¦‚æœ apps/helix/components/Button.tsx å­˜åœ¨
# ç§»åŠ¨åˆ° packages/shared/components/ui/Button.tsxï¼ˆå·²åˆ›å»ºï¼‰
```

**æ›´æ–° apps/helix ä¸­çš„å¯¼å…¥**:

```typescript
// ä¹‹å‰
import Button from '@/components/Button'

// ä¹‹å
import { Button } from '@biya/shared'
```

---

### æ­¥éª¤ 3.5ï¼šæ›´æ–°ä¸»é¢˜ç›¸å…³ä»£ç 

**æ›¿æ¢ context/ThemeContext.tsx**:

```typescript
// apps/helix/app/[locale]/layout.tsx
import { ThemeScript } from '@biya/theme'

export default function RootLayout({ children }) {
  return (
    <html suppressHydrationWarning>
      <head>
        <ThemeScript />
      </head>
      <body>{children}</body>
    </html>
  )
}
```

**æ›´æ–°ç»„ä»¶ä½¿ç”¨ä¸»é¢˜**:

```typescript
// ä¹‹å‰
import { useTheme } from '@/context/ThemeContext'

// ä¹‹å
import { useThemeStore } from '@biya/theme'

function Component() {
  const { isDark, toggleTheme } = useThemeStore()
  // ...
}
```

---

### æ­¥éª¤ 3.6ï¼šæµ‹è¯• Helix åº”ç”¨

```bash
cd D:\rwa\biya-coin

# å®‰è£…ä¾èµ–ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
npm install

# å¯åŠ¨ Helix åº”ç”¨
npm run dev:helix

# åœ¨æµè§ˆå™¨ä¸­è®¿é—® http://localhost:3000
```

**éªŒè¯æ¸…å•**:
- [ ] åº”ç”¨èƒ½æ­£å¸¸å¯åŠ¨
- [ ] é¡µé¢æ¸²æŸ“æ­£å¸¸
- [ ] ä¸»é¢˜åˆ‡æ¢å·¥ä½œæ­£å¸¸
- [ ] å›½é™…åŒ–å·¥ä½œæ­£å¸¸
- [ ] æ—  TypeScript é”™è¯¯

---

## ğŸŒ‰ é˜¶æ®µ 4ï¼šåˆ†ç¦» Bridge åº”ç”¨

### æ­¥éª¤ 4.1ï¼šåˆ›å»º Bridge åº”ç”¨ç›®å½•

```bash
cd D:\rwa\biya-coin\apps
mkdir bridge
cd bridge
```

---

### æ­¥éª¤ 4.2ï¼šåˆ›å»º Bridge package.json

```json
{
  "name": "@biya/bridge",
  "version": "1.0.0",
  "private": true,
  "scripts": {
    "dev": "next dev -p 3001",
    "build": "next build",
    "start": "next start -p 3001",
    "lint": "next lint",
    "type-check": "tsc --noEmit"
  },
  "dependencies": {
    "@biya/shared": "*",
    "@biya/theme": "*",
    "@biya/i18n": "*",
    "@biya/wallet": "*",
    "@0xsquid/sdk": "^2.10.2",
    "@0xsquid/squid-types": "^0.1.191",
    "@axelar-network/axelarjs-sdk": "^0.17.9",
    "@injectivelabs/exceptions": "1.16.7",
    "@injectivelabs/networks": "1.16.7",
    "@injectivelabs/sdk-ts": "1.16.7",
    "@injectivelabs/wallet-strategy": "1.16.7",
    "@ethereumjs/tx": "^4.1.1",
    "@tanstack/react-query": "^5.90.5",
    "bignumber.js": "^9.1.2",
    "ethers": "^6.15.0",
    "next": "15.5.4",
    "react": "19.1.0",
    "react-dom": "19.1.0",
    "react-hook-form": "^7.65.0",
    "viem": "^2.38.5",
    "wagmi": "^2.19.1",
    "zustand": "^5.0.8"
  },
  "devDependencies": {
    "@types/node": "^20",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "typescript": "^5"
  }
}
```

---

### æ­¥éª¤ 4.3ï¼šå¤åˆ¶ Bridge ç›¸å…³ä»£ç 

```bash
cd D:\rwa\biya-coin

# ä» apps/helix å¤åˆ¶åˆ° apps/bridge

# å¤åˆ¶ Bridge é¡µé¢
cp -r apps/helix/app/[locale]/bridge apps/bridge/app/[locale]/

# å¤åˆ¶ Bridge ç»„ä»¶
mkdir -p apps/bridge/components/bridge
cp -r apps/helix/components/bridge/* apps/bridge/components/bridge/

# å¤åˆ¶ Bridge Context
mkdir -p apps/bridge/context/bridge
cp -r apps/helix/context/bridge/* apps/bridge/context/bridge/

# å¤åˆ¶ Bridge ä¸šåŠ¡é€»è¾‘
mkdir -p apps/bridge/lib/bridge
cp -r apps/helix/lib/bridge/* apps/bridge/lib/bridge/

# å¤åˆ¶ Bridge ç¿»è¯‘
mkdir -p apps/bridge/messages
# ä» apps/helix/messages æå– bridge ç›¸å…³ç¿»è¯‘

# å¤åˆ¶ Bridge å›¾ç‰‡
mkdir -p apps/bridge/public/images/chains
cp -r apps/helix/public/images/chains/* apps/bridge/public/images/chains/
```

---

### æ­¥éª¤ 4.4ï¼šåˆ›å»º Bridge next.config.ts

```typescript
import type { NextConfig } from 'next'
import createNextIntlPlugin from 'next-intl/plugin'
import path from 'path'

const withNextIntl = createNextIntlPlugin('./i18n/request.ts')

const nextConfig: NextConfig = {
  reactStrictMode: true,
  
  experimental: {
    optimizePackageImports: [
      '@biya/shared',
      '@biya/theme',
      '@biya/wallet',
      'lucide-react'
    ],
  },
  
  webpack: (config, { isServer }) => {
    // Vendor åˆ«å
    config.resolve.alias = {
      ...config.resolve.alias,
      '@injectivelabs/core-proto-ts': path.resolve(
        __dirname,
        '../../vendor/injective/core-proto-ts'
      ),
    }
    
    // Node.js polyfills
    if (!isServer) {
      config.resolve.fallback = {
        ...config.resolve.fallback,
        crypto: require.resolve('crypto-browserify'),
        stream: require.resolve('stream-browserify'),
        buffer: require.resolve('buffer/'),
        util: require.resolve('util/'),
        process: require.resolve('process/browser'),
      }
    }
    
    return config
  },
  
  transpilePackages: [
    '@injectivelabs/sdk-ts',
    '@injectivelabs/wallet-strategy',
    '@0xsquid/sdk',
  ],
}

export default withNextIntl(nextConfig)
```

---

### æ­¥éª¤ 4.5ï¼šåˆ›å»º Bridge tsconfig.json

```json
{
  "extends": "../../tsconfig.json",
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["./*"],
      "@biya/shared": ["../../packages/shared"],
      "@biya/theme": ["../../packages/theme"],
      "@biya/i18n": ["../../packages/i18n"],
      "@biya/wallet": ["../../packages/wallet"]
    },
    "plugins": [
      {
        "name": "next"
      }
    ]
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx",
    ".next/types/**/*.ts"
  ],
  "exclude": [
    "node_modules"
  ]
}
```

---

### æ­¥éª¤ 4.6ï¼šåˆ›å»º Bridge ä¸»é¡µé¢

**apps/bridge/app/[locale]/page.tsx**:

```typescript
import { getTranslations } from 'next-intl/server'
import BridgeFromV2 from '@/components/bridge/BridgeFromV2'

export default async function BridgePage() {
  const t = await getTranslations('bridge')
  
  return (
    <div className="min-h-screen py-12 px-4">
      <div className="max-w-2xl mx-auto">
        <div className="mb-8 text-center">
          <h1 className="text-4xl font-bold mb-4">
            {t('title')}
          </h1>
          <p className="text-gray-400 text-lg">
            {t('subtitle')}
          </p>
        </div>
        <BridgeFromV2 />
      </div>
    </div>
  )
}
```

---

### æ­¥éª¤ 4.7ï¼šåˆ›å»º Bridge Layout

**apps/bridge/app/[locale]/layout.tsx**:

```typescript
import type { Metadata } from 'next'
import { NextIntlClientProvider } from 'next-intl'
import { getMessages } from 'next-intl/server'
import { ThemeScript } from '@biya/theme'
import { BridgeProviders } from '@/context/bridge/BridgeProviders'
import '../globals.css'

export const metadata: Metadata = {
  title: 'Biya Bridge - Cross-Chain Asset Transfer',
  description: 'Transfer assets between Ethereum, BSC, and Injective',
}

export default async function RootLayout({
  children,
  params: { locale }
}: {
  children: React.ReactNode
  params: { locale: string }
}) {
  const messages = await getMessages()

  return (
    <html lang={locale} suppressHydrationWarning>
      <head>
        <ThemeScript />
      </head>
      <body>
        <NextIntlClientProvider messages={messages}>
          <BridgeProviders>
            {children}
          </BridgeProviders>
        </NextIntlClientProvider>
      </body>
    </html>
  )
}
```

---

### æ­¥éª¤ 4.8ï¼šæµ‹è¯• Bridge åº”ç”¨

```bash
cd D:\rwa\biya-coin

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨ Bridge åº”ç”¨ï¼ˆç«¯å£ 3001ï¼‰
npm run dev:bridge

# åœ¨æµè§ˆå™¨ä¸­è®¿é—® http://localhost:3001
```

---

## âš™ï¸ é˜¶æ®µ 5ï¼šé…ç½®å’Œä¼˜åŒ–

### æ­¥éª¤ 5.1ï¼šé…ç½® Vercel éƒ¨ç½²

**apps/helix/vercel.json**:

```json
{
  "buildCommand": "cd ../.. && npm run build:helix",
  "outputDirectory": ".next",
  "framework": "nextjs",
  "installCommand": "npm install",
  "devCommand": "npm run dev",
  "ignoreCommand": "node ../../scripts/vercel-ignore-helix.js"
}
```

**apps/bridge/vercel.json**:

```json
{
  "buildCommand": "cd ../.. && npm run build:bridge",
  "outputDirectory": ".next",
  "framework": "nextjs",
  "installCommand": "npm install",
  "devCommand": "npm run dev -- -p 3001",
  "ignoreCommand": "node ../../scripts/vercel-ignore-bridge.js"
}
```

---

### æ­¥éª¤ 5.2ï¼šåˆ›å»º Vercel å¿½ç•¥è„šæœ¬

**scripts/vercel-ignore-helix.js**:

```javascript
const { execSync } = require('child_process')

const diff = execSync('git diff HEAD^ HEAD --name-only').toString().trim()
const changedFiles = diff.split('\n')

const shouldBuild = changedFiles.some(file => 
  file.startsWith('apps/helix/') || 
  file.startsWith('packages/')
)

process.exit(shouldBuild ? 1 : 0)
```

**scripts/vercel-ignore-bridge.js**:

```javascript
const { execSync } = require('child_process')

const diff = execSync('git diff HEAD^ HEAD --name-only').toString().trim()
const changedFiles = diff.split('\n')

const shouldBuild = changedFiles.some(file => 
  file.startsWith('apps/bridge/') || 
  file.startsWith('packages/shared/') ||
  file.startsWith('packages/theme/') ||
  file.startsWith('packages/wallet/')
)

process.exit(shouldBuild ? 1 : 0)
```

---

### æ­¥éª¤ 5.3ï¼šä¼˜åŒ–å…±äº«åŒ…

**æ·»åŠ æ›´å¤šé€šç”¨ç»„ä»¶åˆ° @biya/shared**:

ä» `apps/helix/components` ä¸­è¯†åˆ«å¯å¤ç”¨çš„ç»„ä»¶ï¼Œç§»åŠ¨åˆ° `packages/shared/components`:

- Card.tsx
- Input.tsx
- Modal.tsx
- Loading.tsx
- Header.tsx
- Footer.tsx

---

### æ­¥éª¤ 5.4ï¼šé…ç½® ESLint å’Œ Prettier

**æ ¹ç›®å½• .eslintrc.json**:

```json
{
  "extends": ["next/core-web-vitals"],
  "ignorePatterns": ["node_modules", ".next", "dist"]
}
```

**æ ¹ç›®å½• .prettierrc**:

```json
{
  "semi": false,
  "singleQuote": true,
  "tabWidth": 2,
  "trailingComma": "es5",
  "printWidth": 100
}
```

---

## âœ… é˜¶æ®µ 6ï¼šæµ‹è¯•å’ŒéªŒè¯

### æ­¥éª¤ 6.1ï¼šè¿è¡Œå®Œæ•´æµ‹è¯•

```bash
cd D:\rwa\biya-coin

# æ¸…ç†æ‰€æœ‰æ„å»º
npm run clean:build

# å®‰è£…ä¾èµ–
npm install

# ç±»å‹æ£€æŸ¥
npm run type-check

# Lint æ£€æŸ¥
npm run lint

# æ„å»ºæ‰€æœ‰åº”ç”¨
npm run build

# å¯åŠ¨ Helix
npm run start:helix

# å¯åŠ¨ Bridgeï¼ˆæ–°ç»ˆç«¯ï¼‰
npm run start:bridge
```

---

### æ­¥éª¤ 6.2ï¼šåŠŸèƒ½æµ‹è¯•æ¸…å•

#### Helix åº”ç”¨
- [ ] é¦–é¡µåŠ è½½æ­£å¸¸
- [ ] å¯¼èˆªèœå•å·¥ä½œæ­£å¸¸
- [ ] ä¸»é¢˜åˆ‡æ¢ï¼ˆäº®è‰²/æš—è‰²ï¼‰
- [ ] è¯­è¨€åˆ‡æ¢ï¼ˆen/zh/ja/ko/esï¼‰
- [ ] æ‰€æœ‰é¡µé¢è·¯ç”±æ­£å¸¸
- [ ] æ— æ§åˆ¶å°é”™è¯¯

#### Bridge åº”ç”¨
- [ ] Bridge é¡µé¢åŠ è½½
- [ ] é’±åŒ…è¿æ¥æ­£å¸¸
- [ ] ç½‘ç»œé€‰æ‹©æ­£å¸¸
- [ ] ä»£å¸é€‰æ‹©æ­£å¸¸
- [ ] é‡‘é¢è¾“å…¥æ­£å¸¸
- [ ] äº¤æ˜“æµç¨‹å®Œæ•´
- [ ] ä¸»é¢˜åˆ‡æ¢å·¥ä½œ
- [ ] è¯­è¨€åˆ‡æ¢å·¥ä½œ

---

### æ­¥éª¤ 6.3ï¼šæ€§èƒ½æ£€æŸ¥

```bash
# æ£€æŸ¥ Bundle å¤§å°
npm run build:helix
npm run build:bridge

# æŸ¥çœ‹æ„å»ºè¾“å‡ºï¼Œç¡®ä¿ï¼š
# - å…±äº«åŒ…è¢«æ­£ç¡®æ‰“åŒ…
# - æ²¡æœ‰é‡å¤ä¾èµ–
# - Bundle å¤§å°åˆç†
```

---

### æ­¥éª¤ 6.4ï¼šæäº¤ä»£ç 

```bash
cd D:\rwa\biya-coin

# æ·»åŠ æ‰€æœ‰æ›´æ”¹
git add .

# æäº¤
git commit -m "feat: migrate to Monorepo architecture

- Created Monorepo structure with apps/ and packages/
- Created shared packages: @biya/shared, @biya/theme, @biya/wallet
- Migrated biya-helix-app to apps/helix
- Separated Bridge functionality to apps/bridge
- Configured Vercel for independent deployment
- Added TypeScript path aliases for all packages
"

# æ¨é€åˆ°è¿œç¨‹ï¼ˆå¦‚æœéœ€è¦ï¼‰
git push origin feature/monorepo-migration
```

---

## ğŸ“‹ å®Œæ•´éªŒè¯æ¸…å•

### ç›®å½•ç»“æ„
- [ ] `apps/helix` å­˜åœ¨ä¸”ç»“æ„æ­£ç¡®
- [ ] `apps/bridge` å­˜åœ¨ä¸”ç»“æ„æ­£ç¡®
- [ ] `packages/shared` å­˜åœ¨ä¸”åŒ…å«é€šç”¨ç»„ä»¶
- [ ] `packages/theme` å­˜åœ¨ä¸”åŒ…å«ä¸»é¢˜ç®¡ç†
- [ ] `packages/wallet` å­˜åœ¨ä¸”åŒ…å«é’±åŒ…ç®¡ç†

### é…ç½®æ–‡ä»¶
- [ ] æ ¹ `package.json` é…ç½®äº† workspaces
- [ ] æ ¹ `tsconfig.json` é…ç½®äº† paths
- [ ] æ¯ä¸ª app æœ‰ç‹¬ç«‹çš„ `next.config.ts`
- [ ] æ¯ä¸ª package æœ‰ç‹¬ç«‹çš„ `package.json`

### åŠŸèƒ½æµ‹è¯•
- [ ] Helix åº”ç”¨ç‹¬ç«‹è¿è¡Œæ­£å¸¸
- [ ] Bridge åº”ç”¨ç‹¬ç«‹è¿è¡Œæ­£å¸¸
- [ ] ä¸¤ä¸ªåº”ç”¨å¯ä»¥åŒæ—¶è¿è¡Œï¼ˆä¸åŒç«¯å£ï¼‰
- [ ] ä¸»é¢˜åˆ‡æ¢åœ¨ä¸¤ä¸ªåº”ç”¨ä¸­åŒæ­¥
- [ ] é’±åŒ…è¿æ¥çŠ¶æ€åœ¨ä¸¤ä¸ªåº”ç”¨ä¸­å…±äº«ï¼ˆå¦‚æœæ‰“å¼€ï¼‰

### æ„å»ºå’Œéƒ¨ç½²
- [ ] `npm run build:helix` æˆåŠŸ
- [ ] `npm run build:bridge` æˆåŠŸ
- [ ] `npm run build` æˆåŠŸï¼ˆæ„å»ºæ‰€æœ‰ï¼‰
- [ ] Vercel é…ç½®æ­£ç¡®
- [ ] å¯ä»¥ç‹¬ç«‹éƒ¨ç½²æ¯ä¸ªåº”ç”¨

---

## ğŸ‰ å®Œæˆï¼

æ­å–œï¼ä½ å·²ç»æˆåŠŸå°† `biya-helix-app` è¿ç§»åˆ° Monorepo æ¶æ„ã€‚

---

## ğŸš€ ä¸‹ä¸€æ­¥

ç»§ç»­é˜…è¯»ï¼š

**â†’ [07-éƒ¨ç½²æ–¹æ¡ˆ.md](./07-éƒ¨ç½²æ–¹æ¡ˆ.md)**

äº†è§£å¦‚ä½•åœ¨ Vercel æˆ–è‡ªå»ºæœåŠ¡å™¨ä¸Šéƒ¨ç½² Monorepo åº”ç”¨ã€‚

---

## ğŸ“š æœ¬ç« å°ç»“

### è¿ç§»æ­¥éª¤

1. **å‡†å¤‡å·¥ä½œ**: å¤‡ä»½ä»£ç ã€å®‰è£…å·¥å…·
2. **åˆ›å»ºç»“æ„**: Monorepo æ ¹ç›®å½•å’Œé…ç½®
3. **åˆ›å»ºå…±äº«åŒ…**: sharedã€themeã€wallet ç­‰
4. **è¿ç§»ä¸»åº”ç”¨**: ç§»åŠ¨ helix åˆ° apps/helix
5. **åˆ†ç¦» Bridge**: ç‹¬ç«‹ Bridge åº”ç”¨åˆ° apps/bridge
6. **é…ç½®ä¼˜åŒ–**: Vercel é…ç½®ã€ESLintã€Prettier
7. **æµ‹è¯•éªŒè¯**: åŠŸèƒ½æµ‹è¯•ã€æ€§èƒ½æ£€æŸ¥

### å…³é”®ç‚¹

- **æ¸è¿›å¼è¿ç§»**: ä¸€æ­¥æ­¥å®Œæˆï¼Œæ¯æ­¥éªŒè¯
- **ä¿æŒç‹¬ç«‹**: æ¯ä¸ªåº”ç”¨å¯ä»¥ç‹¬ç«‹è¿è¡Œå’Œéƒ¨ç½²
- **ä»£ç å¤ç”¨**: å…±äº«åŒ…æé«˜ä»£ç å¤ç”¨ç‡
- **ç±»å‹å®‰å…¨**: å®Œæ•´çš„ TypeScript æ”¯æŒ

---

*æœ€åæ›´æ–°: 2025-10-31*

