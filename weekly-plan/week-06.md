# Week 6: UI瀹屽杽 (Day 36-42)

**涓婁竴鍛?*: [Week 5](./week-05.md) | **涓嬩竴鍛?*: [Week 7](./week-07.md)
## Week 6: UI完善 (Day 36-42)

**目标**: 图表、设置、通知、推荐积分功能完善  
**负责人**: 2-3名开发  
**验收**: 所有UI组件完善，用户体验良好

---

### Day 36-38: 图表集成与优化

**负责人**: 1名前端专家  
**工作时间**: 24小时

#### 任务36.1: TradingView完整集成 (8小时)

**参考文件**: `injective-helix-demo/app/trading-view/`

**详细步骤**:
1. TradingView Library配置
   - 完整配置TradingView Charting Library
   - 或继续使用lightweight-charts优化
   - 配置主题适配
   - 配置工具栏

2. 数据源适配
   - 创建数据feed接口
   - 实现getBars方法（获取历史K线）
   - 实现subscribeBars方法（实时K线）
   - 实现unsubscribeBars方法

3. K线数据Service
   - 创建 `src/lib/services/candles.service.ts`
   - 获取历史K线数据
   - 订阅实时K线更新
   - 缓存数据

4. 时间周期切换
   - 支持多种时间周期：1m, 5m, 15m, 30m, 1h, 4h, 1d, 1w
   - 快速切换按钮
   - 保存用户偏好

5. 图表类型
   - 蜡烛图（默认）
   - 折线图
   - 面积图
   - 柱状图

6. 技术指标（基础）
   - MA（移动平均线）
   - MACD
   - RSI
   - 布林带

7. 画线工具（基础）
   - 趋势线
   - 水平线
   - 矩形
   - 保存画线

8. 图表设置
   - 保存图表布局
   - 恢复图表布局
   - 导出图表图片

9. 性能优化
   - Canvas渲染优化
   - 数据抽样
   - 节流更新

10. 测试图表
    - 测试数据加载
    - 测试实时更新
    - 测试所有功能
    - 测试性能

**交付物**:
- [ ] 完整的TradingView集成
- [ ] candles.service.ts
- [ ] 所有图表功能

**验收标准**:
- 图表流畅显示
- 实时更新正常
- 所有功能可用
- 性能良好

---

#### 任务36.2: 深度图组件 (4小时)

**参考文件**: `injective-helix-demo/components/Partials/Charts/`

**详细步骤**:
1. DepthChart组件
   - 创建 `src/components/charts/DepthChart.tsx`
   - 使用lightweight-charts或ApexCharts
   - 面积图显示买卖深度

2. 数据处理
   - 从orderbook数据生成深度数据
   - 累计数量计算
   - 实时更新

3. 交互功能
   - Hover显示价格和数量
   - 点击价格填充到下单表单
   - 缩放和平移

4. 样式设计
   - 买单绿色
   - 卖单红色
   - 主题适配

5. 集成到交易页面
   - 作为可选视图
   - 与订单簿切换

6. 测试组件
   - 测试深度图显示
   - 测试实时更新
   - 测试交互

**交付物**:
- [ ] DepthChart组件

**验收标准**:
- 深度图准确
- 实时更新流畅
- 交互正常

---

#### 任务36.3: 资产分布与趋势图 (4小时)

**详细步骤**:
1. AssetDistributionChart组件
   - 使用ApexCharts
   - 饼图或环形图
   - 显示各币种占比
   - 交互：点击查看详情

2. AssetTrendChart组件
   - 折线图显示资产变化
   - 时间范围选择
   - 显示关键节点（大额交易、盈亏）
   - 可缩放

3. 数据获取
   - 创建资产历史Service
   - 获取历史资产数据
   - 缓存数据

4. 图表配置
   - 主题适配
   - 响应式
   - 动画效果

5. 测试图表
   - 测试数据准确性
   - 测试交互

**交付物**:
- [ ] AssetDistributionChart组件
- [ ] AssetTrendChart组件

**验收标准**:
- 图表美观
- 数据准确
- 交互流畅

---

#### 任务36.4: 盈亏图表 (4小时)

**详细步骤**:
1. PnLChart组件
   - 折线图显示累计盈亏
   - 柱状图显示日盈亏
   - 组合图表

2. 数据计算
   - 每日盈亏统计
   - 累计盈亏计算
   - 分市场统计

3. 时间范围选择
   - 今天/7天/30天/全部
   - 自定义时间范围

4. 交互功能
   - Hover显示详情
   - 点击查看该日交易

5. 测试图表

**交付物**:
- [ ] PnLChart组件

**验收标准**:
- 盈亏计算准确
- 图表清晰

---

#### 任务36.5: 图表优化与响应式 (4小时)

**详细步骤**:
1. 性能优化
   - Canvas渲染优化
   - 数据抽样（大量数据时）
   - 节流更新频率
   - 懒加载

2. 响应式适配
   - 桌面端布局
   - 平板布局
   - 手机端布局
   - 图表大小自适应

3. 主题适配
   - 亮色主题配色
   - 暗色主题配色
   - 动态切换

4. 加载状态
   - 骨架屏
   - Loading动画
   - 错误处理

5. 测试优化效果
   - 性能测试
   - 响应式测试
   - 主题测试

**交付物**:
- [ ] 图表优化

**验收标准**:
- 性能良好
- 响应式正常
- 主题适配正确

---

### Day 39-40: 设置与通知

**负责人**: 1名开发  
**工作时间**: 16小时

#### 任务39.1: 创建Settings Store (2小时)

**详细步骤**:
1. 创建settings store
   - 创建 `src/lib/store/settingsStore.ts`
   - 定义设置类型

2. 设置项
   - 界面设置（主题、语言、字体大小）
   - 交易设置（默认滑点、默认杠杆、确认开关）
   - 通知设置（类型开关、渠道选择）
   - 隐私设置

3. 持久化
   - 保存到localStorage
   - 加载设置
   - 同步到云端（可选）

4. 测试store

**交付物**:
- [ ] settingsStore.ts
- [ ] Settings类型

**验收标准**:
- Store功能正常
- 持久化正常

---

#### 任务39.2: 设置页面 (4小时)

**参考文件**: `injective-helix-demo/pages/`

**详细步骤**:
1. 创建设置页面
   - 创建 `src/app/settings/page.tsx`
   - Tab布局

2. 通用设置Tab
   - 主题选择（亮色/暗色/自动）
   - 语言选择（中文/英文）
   - 时区设置
   - 日期格式
   - 小数点位数

3. 交易设置Tab
   - 默认滑点
   - 默认杠杆
   - 确认开关（交易确认、大额警告）
   - 快捷百分比自定义

4. 通知设置Tab
   - 订单通知开关
   - 价格预警开关
   - 系统消息开关
   - 通知声音开关

5. 隐私设置Tab
   - 数据收集开关
   - Analytics开关

6. 账户设置Tab
   - 显示钱包地址
   - 连接的钱包列表
   - 断开连接按钮

7. 关于Tab
   - 版本信息
   - 更新日志
   - 反馈渠道
   - 社交媒体链接

8. 测试页面
   - 测试所有设置项
   - 测试持久化

**交付物**:
- [ ] 设置页面
- [ ] 所有设置Tab

**验收标准**:
- 设置项完整
- 保存生效正常

---

#### 任务39.3: Notification Store (2小时)

**参考文件**: `injective-helix-demo/store/`

**详细步骤**:
1. 创建notification store
   - 创建 `src/lib/store/notificationStore.ts`
   - 定义通知类型

2. 通知管理
   - 通知列表
   - 未读数量
   - 添加通知
   - 标记已读
   - 删除通知

3. 通知类型
   - 订单通知
   - 价格预警
   - 系统消息
   - 活动通知

4. 测试store

**交付物**:
- [ ] notificationStore.ts

**验收标准**:
- Store功能正常

---

#### 任务39.4: Toast通知组件 (2小时)

**详细步骤**:
1. Toast组件（如果未创建）
   - 成功/错误/警告/信息类型
   - 自动消失
   - 手动关闭
   - 多个Toast堆叠

2. Toast Provider
   - 全局Toast管理
   - useToast hook

3. 集成到应用
   - 所有操作结果显示Toast
   - 错误提示
   - 成功提示

4. 测试Toast

**交付物**:
- [ ] Toast系统

**验收标准**:
- Toast显示正常
- 样式美观

---

#### 任务39.5: NotificationCenter组件 (3小时)

**详细步骤**:
1. NotificationCenter组件
   - 创建通知中心组件
   - 弹出式面板

2. 通知列表
   - 显示所有通知
   - 分类：全部/订单/预警/系统
   - 未读标识
   - 时间显示

3. 通知操作
   - 标记已读
   - 全部已读
   - 删除通知
   - 清空所有

4. 通知徽章
   - Header显示未读数量
   - 点击打开通知中心

5. 测试组件

**交付物**:
- [ ] NotificationCenter组件

**验收标准**:
- 通知显示正常
- 操作功能正常

---

#### 任务39.6: 价格预警功能 (3小时)

**详细步骤**:
1. PriceAlert Service
   - 创建 `src/lib/services/priceAlert.service.ts`
   - 监控价格变化
   - 触发预警

2. PriceAlert Store
   - 创建价格预警store
   - 预警列表管理

3. PriceAlertModal组件
   - 设置预警
   - 选择市场
   - 选择条件（高于/低于）
   - 输入价格
   - 选择通知方式

4. PriceAlertList组件
   - 显示所有预警
   - 启用/禁用
   - 删除预警
   - 触发后通知

5. 测试功能

**交付物**:
- [ ] 价格预警功能

**验收标准**:
- 预警触发准确
- 通知及时

---

### Day 41-42: 推荐与积分

**负责人**: 1名开发  
**工作时间**: 16小时

#### 任务41.1: Referral Service (2小时)

**参考文件**: `injective-helix-demo/app/services/`

**详细步骤**:
1. 创建referral service
   - 创建 `src/lib/services/referral.service.ts`
   - 生成推荐码
   - 获取推荐记录
   - 获取推荐收益

2. 测试service

**交付物**:
- [ ] referral.service.ts

**验收标准**:
- Service功能正常

---

#### 任务41.2: Referral Store (1小时)

**详细步骤**:
1. 创建referral store
   - 创建 `src/lib/store/referralStore.ts`
   - 推荐码
   - 推荐记录
   - 推荐收益

2. 测试store

**交付物**:
- [ ] referralStore.ts

**验收标准**:
- Store功能正常

---

#### 任务41.3: 推荐页面 (4小时)

**参考文件**: `injective-helix-demo/pages/`

**详细步骤**:
1. 创建推荐页面
   - 创建 `src/app/referral/page.tsx`

2. 推荐码展示
   - 显示用户推荐码
   - 生成推荐链接
   - 复制按钮
   - 分享按钮（Twitter, Telegram）
   - 二维码

3. 推荐统计
   - 推荐人数
   - 总推荐收益
   - 推荐排名

4. 推荐记录
   - 表格显示推荐用户
   - 注册时间
   - 交易量
   - 返佣金额

5. 推荐规则说明
   - 返佣比例
   - 如何获得返佣
   - 规则详情

6. 测试页面

**交付物**:
- [ ] 推荐页面

**验收标准**:
- 页面功能完整
- 推荐链接可用

---

#### 任务41.4: Points Service (2小时)

**详细步骤**:
1. 创建points service
   - 创建 `src/lib/services/points.service.ts`
   - 获取用户积分
   - 获取积分历史
   - 获取积分规则

2. 测试service

**交付物**:
- [ ] points.service.ts

**验收标准**:
- Service功能正常

---

#### 任务41.5: 积分页面 (4小时)

**参考文件**: `injective-helix-demo/pages/points.vue`

**详细步骤**:
1. 创建积分页面
   - 创建 `src/app/points/page.tsx`

2. 积分总览
   - 当前积分（大字显示）
   - 积分等级
   - 距离下一等级所需积分
   - 进度条

3. 获取积分方式
   - 卡片展示各种获取方式
   - 交易获得
   - 推荐获得
   - 活动获得
   - 每日签到

4. 积分历史
   - 表格显示积分变化
   - 获取/消耗记录
   - 时间
   - 原因
   - 金额

5. 积分用途说明
   - 手续费折扣
   - 兑换礼品
   - 其他权益

6. 活动列表
   - 进行中的活动
   - 活动规则
   - 活动奖励
   - 参与按钮

7. 测试页面

**交付物**:
- [ ] 积分页面

**验收标准**:
- 页面功能完整
- 积分显示准确

---

#### 任务41.6: 活动系统（简化） (3小时)

**详细步骤**:
1. Activity Service
   - 创建 `src/lib/services/activity.service.ts`
   - 获取活动列表
   - 获取活动详情
   - 参与活动

2. ActivityList组件
   - 显示活动列表
   - 活动卡片设计
   - 活动状态（进行中/已结束）

3. ActivityDetail Modal
   - 活动详细规则
   - 参与按钮
   - 我的进度

4. 测试功能

**交付物**:
- [ ] 活动系统

**验收标准**:
- 活动展示正常
- 参与功能正常

---

### Day 42: Week 6集成测试与优化 (8小时)

**负责人**: 全员

**详细步骤**:
1. 功能集成测试
   - 测试所有图表功能
   - 测试设置功能
   - 测试通知功能
   - 测试推荐积分功能

2. UI一致性检查
   - 对比Nuxt版本
   - 检查所有页面
   - 统一样式

3. 性能测试
   - 图表性能
   - 页面加载速度
   - 内存占用

4. 响应式测试
   - 桌面端
   - 平板
   - 手机

5. Bug修复
   - 记录Bug
   - 修复
   - 回归测试

6. 代码优化
   - 代码Review
   - 重构优化
   - 添加注释

**交付物**:
- [ ] 测试报告
- [ ] Bug修复记录
- [ ] 优化记录

**验收标准**:
- Week 6所有功能正常
- UI美观一致
- 性能良好
- 无严重Bug

---

### Week 6 验收标准

#### 功能验收
- [ ] TradingView图表完整可用
- [ ] 深度图正常显示
- [ ] 资产图表准确
- [ ] 盈亏图表准确
- [ ] 所有设置项生效
- [ ] Toast通知正常
- [ ] 通知中心功能正常
- [ ] 价格预警正常
- [ ] 推荐功能可用
- [ ] 积分功能可用
- [ ] 活动展示正常

#### 性能验收
- [ ] 图表渲染流畅（FPS > 30）
- [ ] 页面加载 < 2s
- [ ] 内存占用稳定

#### 质量验收
- [ ] 无TypeScript错误
- [ ] 无ESLint错误
- [ ] 计算准确
- [ ] 无严重Bug

#### UI验收
- [ ] 所有页面UI完整
- [ ] 响应式布局正常
- [ ] 主题切换正常
- [ ] 与Nuxt版本风格一致

---


---

**涓婁竴鍛?*: [Week 5](./week-05.md) | **涓嬩竴鍛?*: [Week 7](./week-07.md)
